!function(a,b,c){function d(c,f){if(!b[c]){if(!a[c]){var g="function"==typeof require&&require;if(!f&&g)return g(c,!0);if(e)return e(c,!0);throw new Error("Cannot find module '"+c+"'")}var h=b[c]={exports:{}};a[c][0].call(h.exports,function(b){var e=a[c][1][b];return d(e||b)},h,h.exports)}return b[c].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f])}({1:[function(a,b,c){$(function(){"use strict";var b;if(function(){var a=$(window).width()/17,c=$(window).height()/15.7;JXG.Options.angle.orthoType="root",JXG.Options.angle.radius=25,JXG.Options.polygon.fillOpacity=.46,JXG.Options.polygon.fillColor="#0ece16",JXG.Options.elements.fixed=!1,JXG.Options.text.parse=!1,b=JXG.JSXGraph.initBoard("grid",{boundingbox:[-a,c,a,-c],keepaspectratio:!0,showCopyright:!1,showNavigation:!1}),b.points={},b.shapes=[],b.xx=a,b.yy=c,b.axx=b.create("axis",[[0,0],[1,0]]),b.axy=b.create("axis",[[0,0],[0,1]]),b.unsuspendUpdate()}(),$("#application").hasClass("paste"))a("./helper/play")($AppPaste,b),$(".play").click(),$(".replay").click(function(){a("./helper/play")($AppPaste,b)}),$(".new").click(function(){window.location.href="/"});else{var c=window.app=a("./subscribe")(b);a("./helper/helpers")(c,b),a("./decorators/mouse")(c)}})},{"./subscribe":2,"./helper/helpers":3,"./helper/play":4,"./decorators/mouse":5}],5:[function(a,b,c){b.exports=function(a){MouseEvent.prototype.srcApp=a}},{}],2:[function(a,b,c){var d=a("./operation");b.exports=function(b){var c=new d(b);return a("./subscriptions/board")(c),a("./subscriptions/function")(c),a("./subscriptions/zoom")(c,b),c}},{"./operation":6,"./subscriptions/board":7,"./subscriptions/function":8,"./subscriptions/zoom":9}],3:[function(a,b,c){b.exports=function(b,c){a("./more")(),a("./undo")(b),a("./record")(b),a("./clear")(b),a("./drag")(c),a("./play")(b,c),a("./share")(b),a("./bindings")(b),a("./mouse")(c),a("./dirty")(b)}},{"./undo":10,"./more":11,"./clear":12,"./record":13,"./drag":14,"./play":4,"./share":15,"./bindings":16,"./dirty":17,"./mouse":18}],4:[function(a,b,c){var d=a("../iterate"),e=a("../events/run");b.exports=function(b,c){if(c.playing)return!1;void 0===c.playing&&(c.playing=!0);var f=function(a){for(point in a.points)a.points.hasOwnProperty(point)&&a.removeObject(a.points[point]);a.points={};for(var b=a.shapes.length,c=0;c<b;c++)a.removeObject(a.shapes[c]);a.shapes=[],$(".undo").removeClass("visible"),a.zoom100(),a.update()};if($("#application").hasClass("paste")){f(c);var g=new d($AppPaste);c.animate();var h;$(".replay").addClass("dim"),h=setInterval(function(){var b=g.next();target=b.toString.split(".");var d=e[target[0]][target[1]];a("./position")(b.arguments,c),new d(c,b.arguments).execute(),g.hasNext()||(clearInterval(h),$(".replay").removeClass("dim"),c.playing=void 0)},1100)}else $(".play").click(function(){if(f(c),!Object.isFrozen(b))return!1;var a=new d(b.getRecorded);c.animate();var g;g=setInterval(function(){var b=a.next();target=b.toString.split("."),new(0,e[target[0]][target[1]])(c,b.arguments).execute(),a.hasNext()||(clearInterval(g),c.playing=void 0,$(".play").unbind().addClass("dim"))},1100)})}},{"../iterate":19,"../events/run":20,"./position":21}],10:[function(a,b,c){b.exports=function(a){$(function(){$(".button.undo").click(function(){a.undoLastExecute(),0===a.length&&$(this).removeClass("visible")})})}},{}],11:[function(a,b,c){b.exports=function(){$(function(){var a=3;$("#application").on("click",".more",function(){3==$(this).parent().find(".inside").length&&(a=3),a++;var b='<label for="point'+a+'">Point '+a+' (x,y):</label><input type="text" name="point'+a+'" class="inside" value="0.0,0.0" />';$(this).before(b)})})}},{}],13:[function(a,b,c){b.exports=function(a){$(function(){$(".start-record").click(function(){$(".clear").click(),a.startRecording(),$(this).html("Recording").addClass("dim"),$(this).unbind()}),$(".end-record").click(function(){a.isRecording&&($(".share").removeClass("hidden"),a.stopRecording(),$("#application").addClass("off"),$(this).html("Finished").addClass("finished").prev().html("Start Record"),$(this).unbind(),Object.freeze(a),$(".delete_").addClass("hidden"),$(".undo").removeClass("visible"),$(".reset").show(),$(".reset").click(function(){window.location.reload()}),$(".clear").hide().prev().show())})})}},{}],17:[function(a,b,c){b.exports=function(a){$(window).on("beforeunload",function(){if(!$("#application").hasClass("shared")&&a.isRecording&&a.length)return"You have an unsaved grid paste! Are you sure you want to leave?"})}},{}],18:[function(a,b,c){b.exports=function(a){var b,c,d=function(b,c){var d=a.getCoordsTopLeftCorner(b,c),e=JXG.getPosition(b,c),f=e[0]-d[0],g=e[1]-d[1];return new JXG.Coords(JXG.COORDS_BY_SCREEN,[f,g],a)};a.on("mousemove",function(e){void 0!==c&&(clearTimeout(c),void 0!==a.usrAt&&a.removeObject(a.usrAt)),c=setTimeout(function(){var c=d(e,b).usrCoords.map(function(a){return a});a.usrAt=a.create("text",[parseFloat(c[1]+1.2),parseFloat(c[2]+.5),"("+c[1]+","+c[2]+")"])},1e3)}),$("#grid").mouseout(function(){clearTimeout(c)})}},{}],19:[function(a,b,c){var d=function(a){this.step=0,this.list=a};d.prototype.hasNext=function(){return this.step<this.list.length},d.prototype.next=function(){return this.list[this.step++]},d.prototype.hasPrev=function(){return this.step>0},d.prototype.prev=function(){return this.list[--this.step]},b.exports=d},{}],21:[function(a,b,c){b.exports=function(a,b){var c=!1,d=!1,e=0,f=0,g=function(a){var g;(c||Math.abs(a[0])>b.xx)&&(a[0]<0?(e&&(g=-e/2-3),g=g||a[0]+b.xx-3,a[0]=a[0]-(e?2*g:g)):(e&&(g=e/2+3),g=g||a[0]-b.xx-3,a[0]=a[0]-(e?2*g:g))),(d||Math.abs(a[1])>b.yy)&&(a[1]<0?(f&&(g=-f/1-3),g=g||a[1]+b.yy+3,a[1]=a[1]-g):(f&&(g=f/1+3),g=g||a[1]-b.yy+3,a[1]=a[1]-g))};for(arg in a)if(a.hasOwnProperty(arg)&&$.isArray(a[arg])){if("center"==arg||"position"==arg){var h=a[arg];(Math.abs(h[0])>b.xx||Math.abs(h[1])>b.yy)&&g(a[arg])}if(-1!==arg.indexOf("point")){var h=a[arg];Math.abs(h[0])>b.xx&&(c=!0,Math.abs(h[0])-b.xx>e&&(e=Math.abs(h[0])-b.xx)),Math.abs(h[1])>b.yy&&(d=!0,Math.abs(h[1])-b.yy>f&&(f=Math.abs(h[1])-b.yy))}}if(c||d)for(arg in a)a.hasOwnProperty(arg)&&$.isArray(a[arg])&&arg.match(/point\d?/)&&g(a[arg])}},{}],6:[function(a,b,c){var d=function(a){var b=[];this.commands=b,this.board=a};Object.defineProperty(d.prototype,"length",{get:function(){return this.commands.length}}),Object.defineProperty(d.prototype,"last",{get:function(){return this.commands[this.length-1]}}),d.prototype.store=function(a,b){var c=new a.command(this.board,b);this.commands.push({arguments:b,command:c,toString:a.targetOperation+"."+a.targetCommand})},d.prototype.storeAndExecute=function(a,b){var c=new a.command(this.board,b),b=c.execute();this.commands.push({arguments:b,command:c,toString:a.targetOperation+"."+a.targetCommand})},d.prototype.clearCommandList=function(){this.commands=[]},d.prototype.undoLastExecute=function(){this.commands.pop().command.remove()},a("./decorators/recording")(d),b.exports=d},{"./decorators/recording":22}],7:[function(a,b,c){var d=a("../events/run"),e=a("../helper/slider"),f=(a("../helper/validate")(),a("../../components/rxjs/rx.lite").Rx);b.exports=function(a){var b=$([".circle","  .angle",".arc",".ellipse",".segment",".line",".polygon",".point",".text",".rotate",".reflect",".shear",".translate",".scale",".delete_"].join(",")),c=f.Observable.fromEvent(b,"click");c=c.filter(function(){return!$("#application").hasClass("off")});var g=0,h=(c.subscribe(function(b){g++,a.isRecording||4!=g||alert('Warning: Your actions are not being recorded! Press "Start Record" or the tab key to begin recording');var c=$(b.target);$(".slider").length||e(c.next().html(),230,"auto","#application",c.parent().parent())}),".button.draw, .button.transform, .button.misc"),i=f.Observable.fromEventPattern(function(a){$("#application").on("click",h,a)},function(a){$("#application").off("click",h,a)});i.subscribe(function(b){var c=$(b.target).parent().attr("class").split("-"),e=c[0],f=c[1];if($(b.target).parent().find("[data-error]").length)return void alert($(b.target).parent().find("[data-error]").first().attr("data-error"));var g={targetOperation:e,targetCommand:f,command:d[e][f]};try{a.storeAndExecute(g)}catch(b){return void alert("Warning: "+b.message.replace("JSXGraph: ",""))}a.length>0&&($(".button.delete_").removeClass("hidden"),$(".button.undo").addClass("visible")),$(".close-slider").click()},function(a){console.log("Error: %s",a.message)})}},{"../events/run":20,"../helper/validate":23,"../helper/slider":24,"../../components/rxjs/rx.lite":25}],8:[function(a,b,c){var d=a("../events/run"),e=a("../board/functions/parser"),f=a("../../components/rxjs/rx.lite").Rx;b.exports=function(a){var b=$(".function"),c=f.Observable.fromEvent(b,"keypress");c=c.filter(function(){return!$("#application").hasClass("off")});c.subscribe(function(b){if(13==b.keyCode){var c=new e(b.target.value);try{c.run()}catch(b){return alert("Syntax: "+b.message),!1}var f="func",g=c.identifier||"plot";if(g in d[f]==!1)return void alert("Warning: This GeometryFunction does not exist");var h={targetOperation:f,targetCommand:g,command:d[f][g]};if("plot"===g)try{a.board.jc.snippet(b.target.value,!0,"x,y",!0)}catch(b){return void alert("Expression Error: "+b.message)}try{a.storeAndExecute(h)}catch(b){return void alert("Warning: "+b.message.replace("JSXGraph: ",""))}b.target.value="",a.length>0&&($(".button.undo").addClass("visible"),"plot"===g&&$(".button.delete_").removeClass("hidden")),$(".close-slider").click()}},function(a){console.log("Error: %s",a.message)})}},{"../events/run":20,"../board/functions/parser":26,"../../components/rxjs/rx.lite":25}],9:[function(a,b,c){var d=a("../events/run"),e=a("../../components/rxjs/rx.lite").Rx;b.exports=function(a,b){var c=$(".zoom.in, .zoom.out"),f=e.Observable.fromEvent(c,"click");f=f.filter(function(){return!$("#application").hasClass("off")});f.subscribe(function(c){var e=$(c.target),f=e.hasClass("in")?"zoomIn":"zoomOut";if("zoomIn"==f&&b.zoomX<5.9||"zoomOut"==f&&b.zoomX>.167){var g={targetOperation:"zoom",targetCommand:f,command:d.zoom[f]};try{a.storeAndExecute(g)}catch(c){return void alert("Warning: "+c.message.replace("JSXGraph: ",""))}a.length>0&&$(".button.undo").addClass("visible")}})}},{"../events/run":20,"../../components/rxjs/rx.lite":25}],12:[function(a,b,c){a("../operation");b.exports=function(b){$(function(){var c=b.board;$(".button.clear").click(function(){for(point in c.points)c.points.hasOwnProperty(point)&&c.removeObject(c.points[point]);c.points={};for(var d=c.shapes.length,e=0;e<d;e++)c.removeObject(c.shapes[e]);c.shapes=[],$(".function").val(""),$(".undo").removeClass("visible"),c.zoom100(),c.update(),b.clearCommandList(),a("./record")(b),$(".start-record").removeClass("dim").html("Start Record"),$(".end-record").removeClass("dim").html("End Record")})})}},{"../operation":6,"./record":13}],14:[function(a,b,c){var d,e,f,g,h=a("../events/transform"),i=[];b.exports=function(b){return b.srcApp&&Object.isFrozen(b.srcApp)?(this.isDraggable=!1,!1):$("#application").hasClass("paste")?(this.isDraggable=!1,!1):(this instanceof JXG.Point!=!1||void 0!==this.usrSetCoords)&&(this instanceof JXG.Text==!0?(a("./text.js")(b.srcApp.board,this),this.isDraggable=!1,!1):this instanceof JXG.Point==!0&&Object.keys(this.childElements).length>1?(this.isDraggable=!1,!1):(void 0!==this.usrSetCoords?(d=b.srcApp.board.points[this.usrSetCoords[0].name].X(),e=b.srcApp.board.points[this.usrSetCoords[0].name].Y(),g=this.usrSetCoords.map(function(a){return[b.srcApp.board.points[a.name].X(),b.srcApp.board.points[a.name].Y()]})):(d=b.srcApp.board.points[this.name].X(),e=b.srcApp.board.points[this.name].Y(),g=[[d,e]]),void this.on("drag",function(a){f=this,a.preventDefault(),this.on("mouseup",function(a){if(0===i.length)i=[a.x,a.y];else{if(a.x==i[0]&&a.y==i[1])return;i=[a.x,a.y]}var b,c;"function"!=typeof this.X?(b=this.usrSetCoords[0].X()-d,c=this.usrSetCoords[0].Y()-e):(b=this.X()-d,c=this.Y()-e);var f=h.drag;a.srcApp.store({targetOperation:"transform",targetCommand:"drag",command:f},{figure:this.name,initial:g,values:[b,c]})}.bind(f))})))}},{"./text.js":27,"../events/transform":28}],16:[function(a,b,c){var d=a("../events/run"),e=a("../helper/slider");a("../../components/mousetrap/mousetrap.min"),b.exports=function(a){var b,c=9,f=5;$(function(){for(Mousetrap.bind("ctrl =",function(){$(".zoom.in").click()}),Mousetrap.bind("ctrl -",function(){$(".zoom.out").click()}),Mousetrap.bind("f",function(){setTimeout(function(){$(".function").focus()},200)}),Mousetrap.bind("ctrl+z",function(){$(".undo").click()}),Mousetrap.bind("ctrl+enter",function(){if(a.length){var b=a.last.toString.split(".");if("drag"==b[1])return!1;var c={targetOperation:b[0],targetCommand:b[1],command:d[b[0]][b[1]]};try{a.storeAndExecute(c,a.last.arguments)}catch(a){return void alert("Warning: "+a.message.replace("JSXGraph: ",""))}}}),Mousetrap.bind("m c",function(){$(".clear").click()}),Mousetrap.bind("tab",function(){return $(".start-record").click(),!1}),Mousetrap.bind("escape",function(){$(".close-slider").click()}),Mousetrap.stopCallback=function(a,b,c){return!((" "+b.className+" ").indexOf(" mousetrap ")>-1)&&((!$(b).parent().parent().hasClass("slider")||!c.match(/esc|escape/))&&("INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.contentEditable&&"true"==b.contentEditable))},b=0;b<c;b++)Mousetrap.bind("d "+(b+1),new Function("$('#elements .button').not('.draw').not('.more').eq("+b+").click();"));for(b=0;b<f;b++)Mousetrap.bind("t "+(b+1),new Function("$('#transform .button').not('.transform').not('.more').eq("+b+").click();"));$(".keyboard-hints").click(function(){$(".slider").length||e($(".keyboard-helper").html(),200,460,"#application","body","top")})})}},{"../events/run":20,"../helper/slider":24,"../../components/mousetrap/mousetrap.min":29}],15:[function(a,b,c){var d=a("./slider");b.exports=function(a){var b;$(function(){$(".share").click(function(){if(Object.isFrozen(a)){if(void 0!==b)return void d(b,230,"auto","#application",$("#transform"));d($(this).next().html(),230,"auto","#application",$("#transform")),$("#application").on("click",".submit",function(){var c=a.getRecorded.map(function(a){return delete a.command,a}),e={title:$("input.title:last").val(),paste:c};$(".close-slider").click(),$.ajax({url:"/paste",type:"POST",data:JSON.stringify(e),contentType:"application/json",complete:function(a){b=['<div class="misc-done">','<label for="url">The URL!</label><input type="text" name="url" class="inside url" value="',document.location.href+a.responseJSON.token,'" />',"</div>"].join(""),$("#application").addClass("shared"),d(b,250,"auto","#application",$("#transform"))}})})}})})}},{"./slider":24}],20:[function(a,b,c){b.exports={draw:a("./draw"),transform:a("./transform"),zoom:a("./zoom"),func:a("./function"),misc:a("./misc")}},{"./draw":30,"./transform":28,"./zoom":31,"./function":32,"./misc":33}],22:[function(a,b,c){b.exports=function(a){var b=!1,c=[];Object.defineProperty(a.prototype,"getRecorded",{get:function(){return c}}),Object.defineProperty(a.prototype,"isRecording",{get:function(){return b}}),a.prototype.startRecording=function(){b=!0},a.prototype.stopRecording=function(){b=!1};var d=a.prototype.storeAndExecute;a.prototype.storeAndExecute=function(){d.apply(this,arguments),b&&c.push(this.commands[this.commands.length-1])};var e=a.prototype.store;a.prototype.store=function(){e.apply(this,arguments),b&&c.push(this.commands[this.commands.length-1])};var f=a.prototype.undoLastExecute;a.prototype.undoLastExecute=function(){return b&&c.pop(),f.apply(this,arguments)};var g=a.prototype.clearCommandList;a.prototype.clearCommandList=function(){return b&&(c=[]),g.apply(this,arguments)}}},{}],24:[function(a,b,c){b.exports=function(a,b,c,d,e,f){var g={},h=$('<div class="slider"> <div class="close-slider">x</div> </div>'),i=f&&"top"==f?{width:b||230,height:c||200,position:"absolute",top:-c||-200,right:b/1.35}:{width:b||230,height:c||200,position:"absolute",top:e.offset().top||$("#elements").offset().top,left:-b||-230};h.append(a).appendTo(d||"body").css(i),g[f||"left"]=0,h.animate(g,370,function(){h.find("input:first").focus()}),$(".slider input").keydown(function(a){13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)&&(a.preventDefault(),2==h.find(".button").length?h.find(".button").eq(1).click():h.find(".button").click())}),$(".close-slider").click(function(){$(this).parent().find("*").unbind("click"),g[f||"left"]="top"==f?-c||-230:-b||-230,h.animate(g,370,function(){$(this).remove()})})}},{}],27:[function(a,b,c){var d;b.exports=function(a,b){if(void 0!==b.labelAt)return!1;d=setTimeout(function(){b.labelAt=a.create("text",[b.X()-5,b.Y(),b.name]),setTimeout(function(){void 0!==b.labelAt&&(clearTimeout(d),void 0!==b.labelAt&&(a.removeObject(b.labelAt),delete b.labelAt))},1e3)},300)}},{}],34:[function(a,b,c){var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){c.shift()()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.binding=function(a){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],25:[function(a,b,c){!function(a,d){(function(e){function f(){if(this.isDisposed)throw new Error(P)}function g(a){var b=typeof a;return a&&("function"==b||"object"==b)||!1}function h(a){var b=[];if(!g(a))return b;ia.nonEnumArgs&&a.length&&l(a)&&(a=ka.call(a));var c=ia.enumPrototypes&&"function"==typeof a,d=ia.enumErrorProps&&(a===da||a instanceof Error);for(var e in a)c&&"prototype"==e||d&&("message"==e||"name"==e)||b.push(e);if(ia.nonEnumShadows&&a!==ea){var f=a.constructor,h=-1,i=ga.length;if(a===(f&&f.prototype))var j=a===stringProto?_:a===da?W:aa.call(a),k=ha[j];for(;++h<i;)e=ga[h],k&&k[e]||!ba.call(a,e)||b.push(e)}return b}function i(a,b,c){for(var d=-1,e=c(a),f=e.length;++d<f;){var g=e[d];if(!1===b(a[g],g,a))break}return a}function j(a,b){return i(a,b,h)}function k(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}function l(a){return!(!a||"object"!=typeof a)&&aa.call(a)==S}function m(a){return"function"==typeof a}function n(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;var e=typeof a,f=typeof b;if(a===a&&(null==a||null==b||"function"!=e&&"object"!=e&&"function"!=f&&"object"!=f))return!1;var g=aa.call(a),h=aa.call(b);if(g==S&&(g=Z),h==S&&(h=Z),g!=h)return!1;switch(g){case U:case V:return+a==+b;case Y:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case $:case _:return a==String(b)}var i=g==T;if(!i){if(g!=Z||!ia.nodeClass&&(k(a)||k(b)))return!1;var o=!ia.argsObject&&l(a)?Object:a.constructor,p=!ia.argsObject&&l(b)?Object:b.constructor;if(!(o==p||ba.call(a,"constructor")&&ba.call(b,"constructor")||m(o)&&o instanceof o&&m(p)&&p instanceof p||!("constructor"in a&&"constructor"in b)))return!1}c||(c=[]),d||(d=[]);for(var q=c.length;q--;)if(c[q]==a)return d[q]==b;var r=0;if(result=!0,c.push(a),d.push(b),i){if(q=a.length,r=b.length,result=r==q,result)for(;r--;){var s=b[r];if(!(result=n(a[r],s,c,d)))break}}else j(b,function(b,e,f){if(ba.call(f,e))return r++,result=ba.call(a,e)&&n(a[e],b,c,d)}),result&&j(a,function(a,b,c){if(ba.call(c,b))return result=--r>-1});return c.pop(),d.pop(),result}function o(a,b){return 1===a.length&&Array.isArray(a[b])?a[b]:ka.call(a)}function p(a,b){for(var c=new Array(a),d=0;d<a;d++)c[d]=b();return c}function q(a,b){return new jb(function(c){var d=new wa,e=new xa;return e.setDisposable(d),d.setDisposable(a.subscribe(c.onNext.bind(c),function(a){var d,f;try{f=b(a)}catch(a){return void c.onError(a)}d=new wa,e.setDisposable(d),d.setDisposable(f.subscribe(c))},c.onCompleted.bind(c))),e})}function r(a,b){var c=this;return new jb(function(d){var e=0,f=a.length;return c.subscribe(function(c){if(e<f){var g,h=a[e++];try{g=b(c,h)}catch(a){return void d.onError(a)}d.onNext(g)}else d.onCompleted()},d.onError.bind(d),d.onCompleted.bind(d))})}function s(a){return this.select(function(b,c){var d=a(b,c);return M(d)?db(d):d}).mergeObservable()}function t(a,b,c){return a.addListener?(a.addListener(b,c),ta(function(){a.removeListener(b,c)})):a.addEventListener?(a.addEventListener(b,c,!1),ta(function(){a.removeEventListener(b,c,!1)})):void 0}function u(a,b,c){var d=new qa;if(a&&a.length)for(var e=0,f=a.length;e<f;e++)d.add(u(a[e],b,c));else a&&d.add(t(a,b,c));return d}function v(a,b){var c=Ba(a);return new jb(function(a){return b.scheduleWithRelative(c,function(){a.onNext(0),a.onCompleted()})})}function w(a,b,c){return a===b?new jb(function(a){return c.schedulePeriodicWithState(0,b,function(b){return a.onNext(b),b+1})}):Va(function(){return observableTimerDateAndPeriod(c.now()+a,b,c)})}function x(a,b){return new jb(function(c){function d(){g&&(g=!1,c.onNext(f)),e&&c.onCompleted()}var e,f,g;return new qa(a.subscribe(function(a){g=!0,f=a},c.onError.bind(c),function(){e=!0}),b.subscribe(d,c.onError.bind(c),d))})}function y(a,b,c){return new jb(function(d){function e(a,b){j[b]=a;var e;if(g[b]=!0,h||(h=g.every(H))){try{e=c.apply(null,j)}catch(a){return void d.onError(a)}d.onNext(e)}else i&&d.onCompleted()}var f=2,g=[!1,!1],h=!1,i=!1,j=new Array(f);return new qa(a.subscribe(function(a){e(a,0)},d.onError.bind(d),function(){i=!0,d.onCompleted()}),b.subscribe(function(a){e(a,1)},d.onError.bind(d)))})}var z={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},A=z[typeof window]&&window||this,B=z[typeof c]&&c&&!c.nodeType&&c,C=z[typeof b]&&b&&!b.nodeType&&b,D=C&&C.exports===B&&B,E=z[typeof d]&&d;!E||E.global!==E&&E.window!==E||(A=E);var F={internals:{},config:{Promise:A.Promise},helpers:{}},G=F.helpers.noop=function(){},H=F.helpers.identity=function(a){return a},I=F.helpers.defaultNow=Date.now,J=F.helpers.defaultComparer=function(a,b){return ja(a,b)},K=F.helpers.defaultSubComparer=function(a,b){return a>b?1:a<b?-1:0},L=(F.helpers.defaultKeySerializer=function(a){return a.toString()},F.helpers.defaultError=function(a){throw a}),M=F.helpers.isPromise=function(a){return"function"==typeof a.then&&a.then!==F.Observable.prototype.then},N=(F.helpers.asArray=function(){return Array.prototype.slice.call(arguments)},F.helpers.not=function(a){return!a},"Sequence contains no elements."),O="Argument out of range",P="Object has been disposed",Q="object"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_";A.Set&&"function"==typeof(new A.Set)["@@iterator"]&&(Q="@@iterator");var R={done:!0,value:e},S="[object Arguments]",T="[object Array]",U="[object Boolean]",V="[object Date]",W="[object Error]",X="[object Function]",Y="[object Number]",Z="[object Object]",$="[object RegExp]",_="[object String]",aa=Object.prototype.toString,ba=Object.prototype.hasOwnProperty,ca=aa.call(arguments)==S,da=Error.prototype,ea=Object.prototype,fa=ea.propertyIsEnumerable;try{!(aa.call(document)==Z&&!({toString:0}+""))}catch(a){!0}var ga=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ha={};ha[T]=ha[V]=ha[Y]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},ha[U]=ha[_]={constructor:!0,toString:!0,valueOf:!0},ha[W]=ha[X]=ha[$]={constructor:!0,toString:!0},ha[Z]={constructor:!0};var ia={};!function(){var a=function(){this.x=1},b=[];a.prototype={valueOf:1,y:1};for(var c in new a)b.push(c);for(c in arguments);ia.enumErrorProps=fa.call(da,"message")||fa.call(da,"name"),ia.enumPrototypes=fa.call(a,"prototype"),ia.nonEnumArgs=0!=c,ia.nonEnumShadows=!/valueOf/.test(b)}(1),ca||(l=function(a){return!(!a||"object"!=typeof a)&&ba.call(a,"callee")}),m(/x/)&&(m=function(a){return"function"==typeof a&&aa.call(a)==X});var ja=F.internals.isEqual=function(a,b){return n(a,b,[],[])},ka=Array.prototype.slice,la=this.inherits=F.internals.inherits=function(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c},ma=F.internals.addProperties=function(a){for(var b=ka.call(arguments,1),c=0,d=b.length;c<d;c++){var e=b[c];for(var f in e)a[f]=e[f]}},na=(F.internals.addRef=function(a,b){return new jb(function(c){return new qa(b.getDisposable(),a.subscribe(c))})},function(a,b){this.id=a,this.value=b});na.prototype.compareTo=function(a){var b=this.value.compareTo(a.value);return 0===b&&(b=this.id-a.id),b};var oa=F.internals.PriorityQueue=function(a){this.items=new Array(a),this.length=0},pa=oa.prototype;pa.isHigherPriority=function(a,b){return this.items[a].compareTo(this.items[b])<0},pa.percolate=function(a){if(!(a>=this.length||a<0)){var b=a-1>>1;if(!(b<0||b===a)&&this.isHigherPriority(a,b)){var c=this.items[a];this.items[a]=this.items[b],this.items[b]=c,this.percolate(b)}}},pa.heapify=function(a){if(a===e&&(a=0),!(a>=this.length||a<0)){var b=2*a+1,c=2*a+2,d=a;if(b<this.length&&this.isHigherPriority(b,d)&&(d=b),c<this.length&&this.isHigherPriority(c,d)&&(d=c),d!==a){var f=this.items[a];this.items[a]=this.items[d],this.items[d]=f,this.heapify(d)}}},pa.peek=function(){return this.items[0].value},pa.removeAt=function(a){this.items[a]=this.items[--this.length],delete this.items[this.length],this.heapify()},pa.dequeue=function(){var a=this.peek();return this.removeAt(0),a},pa.enqueue=function(a){var b=this.length++;this.items[b]=new na(oa.count++,a),this.percolate(b)},pa.remove=function(a){for(var b=0;b<this.length;b++)if(this.items[b].value===a)return this.removeAt(b),!0;return!1},oa.count=0;var qa=F.CompositeDisposable=function(){this.disposables=o(arguments,0),this.isDisposed=!1,this.length=this.disposables.length},ra=qa.prototype;ra.add=function(a){this.isDisposed?a.dispose():(this.disposables.push(a),this.length++)},ra.remove=function(a){var b=!1;if(!this.isDisposed){var c=this.disposables.indexOf(a);-1!==c&&(b=!0,this.disposables.splice(c,1),this.length--,a.dispose())}return b},ra.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.disposables.slice(0);this.disposables=[],this.length=0;for(var b=0,c=a.length;b<c;b++)a[b].dispose()}},ra.clear=function(){var a=this.disposables.slice(0);this.disposables=[],this.length=0;for(var b=0,c=a.length;b<c;b++)a[b].dispose()},ra.contains=function(a){return-1!==this.disposables.indexOf(a)},ra.toArray=function(){return this.disposables.slice(0)};var sa=F.Disposable=function(a){this.isDisposed=!1,this.action=a||G};sa.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var ta=sa.create=function(a){return new sa(a)},ua=sa.empty={dispose:G},va=function(){function a(a){this.isSingle=a,this.isDisposed=!1,this.current=null}var b=a.prototype;return b.getDisposable=function(){return this.current},b.setDisposable=function(a){if(this.current&&this.isSingle)throw new Error("Disposable has already been assigned");var b,c=this.isDisposed;c||(b=this.current,this.current=a),b&&b.dispose(),c&&a&&a.dispose()},b.dispose=function(){var a;this.isDisposed||(this.isDisposed=!0,a=this.current,this.current=null),a&&a.dispose()},a}(),wa=F.SingleAssignmentDisposable=function(a){function b(){a.call(this,!0)}return la(b,a),b}(va),xa=F.SerialDisposable=function(a){function b(){a.call(this,!1)}return la(b,a),b}(va),ya=(F.RefCountDisposable=function(){function a(a){this.disposable=a,this.disposable.count++,this.isInnerDisposed=!1}function b(a){this.underlyingDisposable=a,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return a.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,0===--this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},b.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},b.prototype.getDisposable=function(){return this.isDisposed?ua:new a(this)},b}(),F.internals.ScheduledItem=function(a,b,c,d,e){this.scheduler=a,this.state=b,this.action=c,this.dueTime=d,this.comparer=e||K,this.disposable=new wa});ya.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},ya.prototype.compareTo=function(a){return this.comparer(this.dueTime,a.dueTime)},ya.prototype.isCancelled=function(){return this.disposable.isDisposed},ya.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var za,Aa=F.Scheduler=function(){function a(a,b,c,d){this.now=a,this._schedule=b,this._scheduleRelative=c,this._scheduleAbsolute=d}function b(a,b){var c=b.first,d=b.second,e=new qa,f=function(b){d(b,function(b){var c=!1,d=!1,g=a.scheduleWithState(b,function(a,b){return c?e.remove(g):d=!0,f(b),ua});d||(e.add(g),c=!0)})};return f(c),e}function c(a,b,c){var d=b.first,e=b.second,f=new qa,g=function(b){e(b,function(b,d){var e=!1,h=!1,i=a[c].call(a,b,d,function(a,b){return e?f.remove(i):h=!0,g(b),ua});h||(f.add(i),e=!0)})};return g(d),f}function d(a,b){return b(),ua}var e=a.prototype;return e.schedulePeriodic=function(a,b){return this.schedulePeriodicWithState(null,a,function(){b()})},e.schedulePeriodicWithState=function(a,b,c){var d=a,e=setInterval(function(){d=c(d)},b);return ta(function(){clearInterval(e)})},e.schedule=function(a){return this._schedule(a,d)},e.scheduleWithState=function(a,b){return this._schedule(a,b)},e.scheduleWithRelative=function(a,b){return this._scheduleRelative(b,a,d)},e.scheduleWithRelativeAndState=function(a,b,c){return this._scheduleRelative(a,b,c)},e.scheduleWithAbsolute=function(a,b){return this._scheduleAbsolute(b,a,d)},e.scheduleWithAbsoluteAndState=function(a,b,c){return this._scheduleAbsolute(a,b,c)},e.scheduleRecursive=function(a){return this.scheduleRecursiveWithState(a,function(a,b){a(function(){b(a)})})},e.scheduleRecursiveWithState=function(a,c){return this.scheduleWithState({first:a,second:c},function(a,c){return b(a,c)})},e.scheduleRecursiveWithRelative=function(a,b){return this.scheduleRecursiveWithRelativeAndState(b,a,function(a,b){a(function(c){b(a,c)})})},e.scheduleRecursiveWithRelativeAndState=function(a,b,d){return this._scheduleRelative({first:a,second:d},b,function(a,b){return c(a,b,"scheduleWithRelativeAndState")})},e.scheduleRecursiveWithAbsolute=function(a,b){return this.scheduleRecursiveWithAbsoluteAndState(b,a,function(a,b){a(function(c){b(a,c)})})},e.scheduleRecursiveWithAbsoluteAndState=function(a,b,d){return this._scheduleAbsolute({first:a,second:d},b,function(a,b){return c(a,b,"scheduleWithAbsoluteAndState")})},a.now=I,a.normalize=function(a){return a<0&&(a=0),a},a}(),Ba=Aa.normalize,Ca=Aa.immediate=function(){function a(a,b){return b(this,a)}function b(a,b,c){for(var d=Ba(d);d-this.now()>0;);return c(this,a)}function c(a,b,c){return this.scheduleWithRelativeAndState(a,b-this.now(),c)}return new Aa(I,a,b,c)}(),Da=Aa.currentThread=function(){function a(a){for(var b;a.length>0;)if(b=a.dequeue(),!b.isCancelled()){for(;b.dueTime-Aa.now()>0;);b.isCancelled()||b.invoke()}}function b(a,b){return this.scheduleWithRelativeAndState(a,0,b)}function c(b,c,d){var f=this.now()+Aa.normalize(c),g=new ya(this,b,d,f);if(e)e.enqueue(g);else{e=new oa(4),e.enqueue(g);try{a(e)}catch(a){throw a}finally{e=null}}return g.disposable}function d(a,b,c){return this.scheduleWithRelativeAndState(a,b-this.now(),c)}var e,f=new Aa(I,b,c,d);return f.scheduleRequired=function(){return null===e},f.ensureTrampoline=function(a){return null===e?this.schedule(a):a()},f}(),Ea=(F.internals.SchedulePeriodicRecursive=function(){function a(a,b){b(0,this._period);try{this._state=this._action(this._state)}catch(a){throw this._cancel.dispose(),a}}function b(a,b,c,d){this._scheduler=a,this._state=b,this._period=c,this._action=d}return b.prototype.start=function(){var b=new wa;return this._cancel=b,b.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,a.bind(this))),b},b}(),G);!function(){function b(){if(!A.postMessage||A.importScripts)return!1;var a=!1,b=A.onmessage;return A.onmessage=function(){a=!0},A.postMessage("","*"),A.onmessage=b,a}function c(a){if("string"==typeof a.data&&a.data.substring(0,g.length)===g){var b=a.data.substring(g.length);(0,h[b])(),delete h[b]}}var d=RegExp("^"+String(aa).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),e="function"==typeof(e=E&&D&&E.setImmediate)&&!d.test(e)&&e,f="function"==typeof(f=E&&D&&E.clearImmediate)&&!d.test(f)&&f;if(void 0!==a&&"[object process]"==={}.toString.call(a))za=a.nextTick;else if("function"==typeof e)za=e,Ea=f;else if(b()){var g="ms.rx.schedule"+Math.random(),h={},i=0;A.addEventListener?A.addEventListener("message",c,!1):A.attachEvent("onmessage",c,!1),za=function(a){var b=i++;h[b]=a,A.postMessage(g+b,"*")}}else if(A.MessageChannel){var j=new A.MessageChannel,k={},l=0;j.port1.onmessage=function(a){var b=a.data;(0,k[b])(),delete k[b]},za=function(a){var b=l++;k[b]=a,j.port2.postMessage(b)}}else"document"in A&&"onreadystatechange"in A.document.createElement("script")?za=function(a){var b=A.document.createElement("script");b.onreadystatechange=function(){a(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},A.document.documentElement.appendChild(b)}:(za=function(a){return setTimeout(a,0)},Ea=clearTimeout)}();var Fa=Aa.timeout=function(){function a(a,b){var c=this,d=new wa,e=za(function(){d.isDisposed||d.setDisposable(b(c,a))});return new qa(d,ta(function(){Ea(e)}))}function b(a,b,c){var d=this,e=Aa.normalize(b);if(0===e)return d.scheduleWithState(a,c);var f=new wa,g=setTimeout(function(){f.isDisposed||f.setDisposable(c(d,a))},e);return new qa(f,ta(function(){clearTimeout(g)}))}function c(a,b,c){return this.scheduleWithRelativeAndState(a,b-this.now(),c)}return new Aa(I,a,b,c)}(),Ga=F.Notification=function(){function a(a,b){this.hasValue=null!=b&&b,this.kind=a}var b=a.prototype;return b.accept=function(a,b,c){return 1===arguments.length&&"object"==typeof a?this._acceptObservable(a):this._accept(a,b,c)},b.toObservable=function(a){var b=this;return a||(a=Ca),new jb(function(c){return a.schedule(function(){b._acceptObservable(c),"N"===b.kind&&c.onCompleted()})})},a}(),Ha=Ga.createOnNext=function(){function a(a){return a(this.value)}function b(a){return a.onNext(this.value)}function c(){return"OnNext("+this.value+")"}return function(d){var e=new Ga("N",!0);return e.value=d,e._accept=a,e._acceptObservable=b,e.toString=c,e}}(),Ia=Ga.createOnError=function(){function a(a,b){return b(this.exception)}function b(a){return a.onError(this.exception)}function c(){return"OnError("+this.exception+")"}return function(d){var e=new Ga("E");return e.exception=d,e._accept=a,e._acceptObservable=b,e.toString=c,e}}(),Ja=Ga.createOnCompleted=function(){function a(a,b,c){return c()}function b(a){return a.onCompleted()}function c(){return"OnCompleted()"}return function(){var d=new Ga("C");return d._accept=a,d._acceptObservable=b,d.toString=c,d}}(),Ka=F.internals.Enumerator=function(a){this._next=a};Ka.prototype.next=function(){return this._next()},Ka.prototype[Q]=function(){return this};var La=F.internals.Enumerable=function(a){this._iterator=a};La.prototype[Q]=function(){return this._iterator()},La.prototype.concat=function(){var a=this;return new jb(function(b){var c;try{c=a[Q]()}catch(a){return void b.onError()}var d,e=new xa,f=Ca.scheduleRecursive(function(a){var f;if(!d){try{f=c.next()}catch(a){return void b.onError(a)}if(f.done)return void b.onCompleted();var g=f.value;M(g)&&(g=db(g));var h=new wa;e.setDisposable(h),h.setDisposable(g.subscribe(b.onNext.bind(b),b.onError.bind(b),function(){a()}))}});return new qa(e,f,ta(function(){d=!0}))})},La.prototype.catchException=function(){var a=this;return new jb(function(b){var c;try{c=a[Q]()}catch(a){return void b.onError()}var d,e,f=new xa,g=Ca.scheduleRecursive(function(a){if(!d){var g;try{g=c.next()}catch(a){return void b.onError(a)}if(g.done)return void(e?b.onError(e):b.onCompleted());var h=g.value;M(h)&&(h=db(h));var i=new wa;f.setDisposable(i),i.setDisposable(h.subscribe(b.onNext.bind(b),function(b){e=b,a()},b.onCompleted.bind(b)))}});return new qa(f,g,ta(function(){d=!0}))})};var Ma=La.repeat=function(a,b){return null==b&&(b=-1),new La(function(){var c=b;return new Ka(function(){return 0===c?R:(c>0&&c--,{done:!1,value:a})})})},Na=La.forEach=function(a,b,c){return b||(b=H),new La(function(){var d=-1;return new Ka(function(){return++d<a.length?{done:!1,value:b.call(c,a[d],d,a)}:R})})},Oa=F.Observer=function(){};Oa.prototype.toNotifier=function(){var a=this;return function(b){return b.accept(a)}},Oa.prototype.asObserver=function(){return new Sa(this.onNext.bind(this),this.onError.bind(this),this.onCompleted.bind(this))};var Pa=Oa.create=function(a,b,c){return a||(a=G),b||(b=L),c||(c=G),new Sa(a,b,c)};Oa.fromNotifier=function(a){return new Sa(function(b){return a(Ha(b))},function(b){return a(Ia(b))},function(){return a(Ja())})};var Qa,Ra=F.internals.AbstractObserver=function(a){function b(){this.isStopped=!1,a.call(this)}return la(b,a),b.prototype.onNext=function(a){this.isStopped||this.next(a)},b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.error(a))},b.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},b.prototype.dispose=function(){this.isStopped=!0},b.prototype.fail=function(a){return!this.isStopped&&(this.isStopped=!0,this.error(a),!0)},b}(Oa),Sa=F.AnonymousObserver=function(a){function b(b,c,d){a.call(this),this._onNext=b,this._onError=c,this._onCompleted=d}return la(b,a),b.prototype.next=function(a){this._onNext(a)},b.prototype.error=function(a){this._onError(a)},b.prototype.completed=function(){this._onCompleted()},b}(Ra),Ta=F.Observable=function(){function a(a){this._subscribe=a}return Qa=a.prototype,Qa.finalValue=function(){var a=this;return new jb(function(b){var c,d=!1;return a.subscribe(function(a){d=!0,c=a},b.onError.bind(b),function(){d?(b.onNext(c),b.onCompleted()):b.onError(new Error(N))})})},Qa.subscribe=Qa.forEach=function(a,b,c){var d;return d="object"==typeof a?a:Pa(a,b,c),this._subscribe(d)},Qa.toArray=function(){function a(a,b){var c=a.slice(0);return c.push(b),c}return this.scan([],a).startWith([]).finalValue()},a}(),Ua=F.internals.ScheduledObserver=function(a){function b(b,c){a.call(this),this.scheduler=b,this.observer=c,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new xa}return la(b,a),b.prototype.next=function(a){var b=this;this.queue.push(function(){b.observer.onNext(a)})},b.prototype.error=function(a){var b=this;this.queue.push(function(){b.observer.onError(a)})},b.prototype.completed=function(){var a=this;this.queue.push(function(){a.observer.onCompleted()})},b.prototype.ensureActive=function(){var a=!1,b=this;!this.hasFaulted&&this.queue.length>0&&(a=!this.isAcquired,this.isAcquired=!0),a&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(function(a){var c;if(!(b.queue.length>0))return void(b.isAcquired=!1);c=b.queue.shift();try{c()}catch(a){throw b.queue=[],b.hasFaulted=!0,a}a()}))},b.prototype.dispose=function(){a.prototype.dispose.call(this),this.disposable.dispose()},b}(Ra);Ta.create=Ta.createWithDisposable=function(a){return new jb(a)};var Va=Ta.defer=function(a){return new jb(function(b){var c;try{c=a()}catch(a){return $a(a).subscribe(b)}return M(c)&&(c=db(c)),c.subscribe(b)})},Wa=Ta.empty=function(a){return a||(a=Ca),new jb(function(b){return a.schedule(function(){b.onCompleted()})})},Xa=Ta.fromArray=function(a,b){return b||(b=Da),new jb(function(c){var d=0;return b.scheduleRecursive(function(b){d<a.length?(c.onNext(a[d++]),b()):c.onCompleted()})})};Ta.fromIterable=function(a,b){return b||(b=Da),new jb(function(c){var d;try{d=a[Q]()}catch(a){return void c.onError(a)}return b.scheduleRecursive(function(a){var b;try{b=d.next()}catch(a){return void c.onError(a)}b.done?c.onCompleted():(c.onNext(b.value),a())})})},Ta.generate=function(a,b,c,d,e){return e||(e=Da),new jb(function(f){var g=!0,h=a;return e.scheduleRecursive(function(a){var e,i;try{g?g=!1:h=c(h),e=b(h),e&&(i=d(h))}catch(a){return void f.onError(a)}e?(f.onNext(i),a()):f.onCompleted()})})};var Ya=Ta.never=function(){return new jb(function(){return ua})};Ta.range=function(a,b,c){return c||(c=Da),new jb(function(d){return c.scheduleRecursiveWithState(0,function(c,e){c<b?(d.onNext(a+c),e(c+1)):d.onCompleted()})})},Ta.repeat=function(a,b,c){return c||(c=Da),null==b&&(b=-1),Za(a,c).repeat(b)};var Za=Ta.return=Ta.returnValue=function(a,b){return b||(b=Ca),new jb(function(c){return b.schedule(function(){c.onNext(a),c.onCompleted()})})},$a=Ta.throw=Ta.throwException=function(a,b){return b||(b=Ca),new jb(function(c){return b.schedule(function(){c.onError(a)})})};Qa.catch=Qa.catchException=function(a){return"function"==typeof a?q(this,a):_a([this,a])};var _a=Ta.catchException=Ta.catch=function(){var a=o(arguments,0);return Na(a).catchException()};Qa.combineLatest=function(){var a=ka.call(arguments);return Array.isArray(a[0])?a[0].unshift(this):a.unshift(this),ab.apply(this,a)};var ab=Ta.combineLatest=function(){var a=ka.call(arguments),b=a.pop();return Array.isArray(a[0])&&(a=a[0]),new jb(function(c){function d(a){var d;if(h[a]=!0,i||(i=h.every(H))){try{d=b.apply(null,k)}catch(a){return void c.onError(a)}c.onNext(d)}else j.filter(function(b,c){return c!==a}).every(H)&&c.onCompleted()}function e(a){j[a]=!0,j.every(H)&&c.onCompleted()}for(var f=function(){return!1},g=a.length,h=p(g,f),i=!1,j=p(g,f),k=new Array(g),l=new Array(g),m=0;m<g;m++)!function(b){l[b]=new wa,l[b].setDisposable(a[b].subscribe(function(a){k[b]=a,d(b)},c.onError.bind(c),function(){e(b)}))}(m);return new qa(l)})};Qa.concat=function(){var a=ka.call(arguments,0);return a.unshift(this),bb.apply(this,a)};var bb=Ta.concat=function(){var a=o(arguments,0);return Na(a).concat()};Qa.concatObservable=Qa.concatAll=function(){return this.merge(1)},Qa.merge=function(a){if("number"!=typeof a)return cb(this,a);var b=this;return new jb(function(c){var d=0,e=new qa,f=!1,g=[],h=function(a){var b=new wa;e.add(b),M(a)&&(a=db(a)),b.setDisposable(a.subscribe(c.onNext.bind(c),c.onError.bind(c),function(){var a;e.remove(b),g.length>0?(a=g.shift(),h(a)):(d--,f&&0===d&&c.onCompleted())}))};return e.add(b.subscribe(function(b){d<a?(d++,h(b)):g.push(b)},c.onError.bind(c),function(){f=!0,0===d&&c.onCompleted()})),e})};var cb=Ta.merge=function(){var a,b;return arguments[0]?arguments[0].now?(a=arguments[0],b=ka.call(arguments,1)):(a=Ca,b=ka.call(arguments,0)):(a=Ca,b=ka.call(arguments,1)),Array.isArray(b[0])&&(b=b[0]),Xa(b,a).mergeObservable()};Qa.mergeObservable=Qa.mergeAll=function(){var a=this;return new jb(function(b){var c=new qa,d=!1,e=new wa;return c.add(e),e.setDisposable(a.subscribe(function(a){var e=new wa;c.add(e),M(a)&&(a=db(a)),e.setDisposable(a.subscribe(function(a){b.onNext(a)},b.onError.bind(b),function(){c.remove(e),d&&1===c.length&&b.onCompleted()}))},b.onError.bind(b),function(){d=!0,1===c.length&&b.onCompleted()})),c})},Qa.skipUntil=function(a){var b=this;return new jb(function(c){var d=!1,e=new qa(b.subscribe(function(a){d&&c.onNext(a)},c.onError.bind(c),function(){d&&c.onCompleted()})),f=new wa;return e.add(f),f.setDisposable(a.subscribe(function(){d=!0,f.dispose()},c.onError.bind(c),function(){f.dispose()})),e})},Qa.switch=Qa.switchLatest=function(){var a=this;return new jb(function(b){var c=!1,d=new xa,e=!1,f=0,g=a.subscribe(function(a){var g=new wa,h=++f;c=!0,d.setDisposable(g),M(a)&&(a=db(a)),g.setDisposable(a.subscribe(function(a){f===h&&b.onNext(a)},function(a){f===h&&b.onError(a)},function(){f===h&&(c=!1,e&&b.onCompleted())}))},b.onError.bind(b),function(){e=!0,c||b.onCompleted()});return new qa(g,d)})},Qa.takeUntil=function(a){var b=this;return new jb(function(c){return new qa(b.subscribe(c),a.subscribe(c.onCompleted.bind(c),c.onError.bind(c),G))})},Qa.zip=function(){if(Array.isArray(arguments[0]))return r.apply(this,arguments);var a=this,b=ka.call(arguments),c=b.pop();return b.unshift(a),new jb(function(d){function e(a){h[a]=!0,h.every(function(a){return a})&&d.onCompleted()}for(var f=b.length,g=p(f,function(){return[]}),h=p(f,function(){return!1}),i=function(b){var e,f;if(g.every(function(a){return a.length>0})){try{f=g.map(function(a){return a.shift()}),e=c.apply(a,f)}catch(a){return void d.onError(a)}d.onNext(e)}else h.filter(function(a,c){return c!==b}).every(H)&&d.onCompleted()},j=new Array(f),k=0;k<f;k++)!function(a){j[a]=new wa,j[a].setDisposable(b[a].subscribe(function(b){g[a].push(b),i(a)},d.onError.bind(d),function(){e(a)}))}(k);return new qa(j)})},Ta.zip=function(){var a=ka.call(arguments,0),b=a.shift();return b.zip.apply(b,a)},Ta.zipArray=function(){var a=o(arguments,0);return new jb(function(b){function c(a){if(f.every(function(a){return a.length>0})){var c=f.map(function(a){return a.shift()});b.onNext(c)}else if(g.filter(function(b,c){return c!==a}).every(H))return void b.onCompleted()}function d(a){if(g[a]=!0,g.every(H))return void b.onCompleted()}for(var e=a.length,f=p(e,function(){return[]}),g=p(e,function(){return!1}),h=new Array(e),i=0;i<e;i++)!function(e){h[e]=new wa,h[e].setDisposable(a[e].subscribe(function(a){f[e].push(a),c(e)},b.onError.bind(b),function(){d(e)}))}(i);var j=new qa(h);return j.add(ta(function(){for(var a=0,b=f.length;a<b;a++)f[a]=[]})),j})},Qa.asObservable=function(){var a=this;return new jb(function(b){return a.subscribe(b)})},Qa.dematerialize=function(){var a=this;return new jb(function(b){return a.subscribe(function(a){return a.accept(b)},b.onError.bind(b),b.onCompleted.bind(b))})},Qa.distinctUntilChanged=function(a,b){var c=this;return a||(a=H),b||(b=J),new jb(function(d){var e,f=!1;return c.subscribe(function(c){var g,h=!1;try{g=a(c)}catch(a){return void d.onError(a)}if(f)try{h=b(e,g)}catch(a){return void d.onError(a)}f&&h||(f=!0,e=g,d.onNext(c))},d.onError.bind(d),d.onCompleted.bind(d))})},Qa.do=Qa.doAction=function(a,b,c){var d,e=this;return"function"==typeof a?d=a:(d=a.onNext.bind(a),b=a.onError.bind(a),c=a.onCompleted.bind(a)),new jb(function(a){return e.subscribe(function(b){try{d(b)}catch(b){a.onError(b)}a.onNext(b)},function(c){if(b){try{b(c)}catch(b){a.onError(b)}a.onError(c)}else a.onError(c)},function(){if(c){try{c()}catch(b){a.onError(b)}a.onCompleted()}else a.onCompleted()})})},Qa.finally=Qa.finallyAction=function(a){var b=this;return new jb(function(c){var d=b.subscribe(c);return ta(function(){try{d.dispose()}catch(a){throw a}finally{a()}})})},Qa.ignoreElements=function(){var a=this;return new jb(function(b){return a.subscribe(G,b.onError.bind(b),b.onCompleted.bind(b))})},Qa.materialize=function(){var a=this;return new jb(function(b){return a.subscribe(function(a){b.onNext(Ha(a))},function(a){b.onNext(Ia(a)),b.onCompleted()},function(){b.onNext(Ja()),b.onCompleted()})})},Qa.repeat=function(a){return Ma(this,a).concat()},Qa.retry=function(a){return Ma(this,a).catchException()},Qa.scan=function(){var a,b,c=!1,d=this;return 2===arguments.length?(c=!0,a=arguments[0],b=arguments[1]):b=arguments[0],new jb(function(e){var f,g,h;return d.subscribe(function(d){try{h||(h=!0),f?g=b(g,d):(g=c?b(a,d):d,f=!0)}catch(a){return void e.onError(a)}e.onNext(g)},e.onError.bind(e),function(){!h&&c&&e.onNext(a),e.onCompleted()})})},Qa.skipLast=function(a){var b=this;return new jb(function(c){var d=[];return b.subscribe(function(b){d.push(b),d.length>a&&c.onNext(d.shift())},c.onError.bind(c),c.onCompleted.bind(c))})},Qa.startWith=function(){var a,b,c=0;return arguments.length&&"now"in Object(arguments[0])?(b=arguments[0],c=1):b=Ca,a=ka.call(arguments,c),Na([Xa(a,b),this]).concat()},Qa.takeLast=function(a,b){return this.takeLastBuffer(a).selectMany(function(a){return Xa(a,b)})},Qa.takeLastBuffer=function(a){var b=this;return new jb(function(c){var d=[];return b.subscribe(function(b){d.push(b),d.length>a&&d.shift()},c.onError.bind(c),function(){c.onNext(d),c.onCompleted()})})},Qa.select=Qa.map=function(a,b){var c=this;return new jb(function(d){var e=0;return c.subscribe(function(f){var g;try{g=a.call(b,f,e++,c)}catch(a){return void d.onError(a)}d.onNext(g)},d.onError.bind(d),d.onCompleted.bind(d))})},Qa.selectMany=Qa.flatMap=function(a,b){return b?this.selectMany(function(c,d){var e=a(c,d);return(M(e)?db(e):e).select(function(a){return b(c,a,d)})}):"function"==typeof a?s.call(this,a):s.call(this,function(){return a})},Qa.selectSwitch=Qa.flatMapLatest=function(a,b){return this.select(a,b).switchLatest()},Qa.skip=function(a){if(a<0)throw new Error(O);var b=this;return new jb(function(c){var d=a;return b.subscribe(function(a){d<=0?c.onNext(a):d--},c.onError.bind(c),c.onCompleted.bind(c))})},Qa.skipWhile=function(a,b){var c=this;return new jb(function(d){var e=0,f=!1;return c.subscribe(function(g){if(!f)try{f=!a.call(b,g,e++,c)}catch(a){return void d.onError(a)}f&&d.onNext(g)},d.onError.bind(d),d.onCompleted.bind(d))})},Qa.take=function(a,b){if(a<0)throw new Error(O);if(0===a)return Wa(b);var c=this;return new jb(function(b){var d=a;return c.subscribe(function(a){d>0&&(d--,b.onNext(a),0===d&&b.onCompleted())},b.onError.bind(b),b.onCompleted.bind(b))})},Qa.takeWhile=function(a,b){var c=this;return new jb(function(d){var e=0,f=!0;return c.subscribe(function(g){if(f){try{f=a.call(b,g,e++,c)}catch(a){return void d.onError(a)}f?d.onNext(g):d.onCompleted()}},d.onError.bind(d),d.onCompleted.bind(d))})},Qa.where=Qa.filter=function(a,b){var c=this;return new jb(function(d){var e=0;return c.subscribe(function(f){var g;try{g=a.call(b,f,e++,c)}catch(a){return void d.onError(a)}g&&d.onNext(f)},d.onError.bind(d),d.onCompleted.bind(d))})},Ta.fromCallback=function(a,b,c,d){return b||(b=Ca),function(){var e=ka.call(arguments,0);return new jb(function(f){return b.schedule(function(){function b(a){var b=a;if(d)try{b=d(arguments)}catch(a){return void f.onError(a)}else 1===b.length&&(b=b[0]);f.onNext(b),f.onCompleted()}e.push(b),a.apply(c,e)})})}},Ta.fromNodeCallback=function(a,b,c,d){return b||(b=Ca),function(){var e=ka.call(arguments,0);return new jb(function(f){return b.schedule(function(){function b(a){if(a)return void f.onError(a);var b=ka.call(arguments,1);if(d)try{b=d(b)}catch(a){return void f.onError(a)}else 1===b.length&&(b=b[0]);f.onNext(b),f.onCompleted()}e.push(b),a.apply(c,e)})})}},Ta.fromEvent=function(a,b,c){return new jb(function(d){return u(a,b,function(a){var b=a;if(c)try{b=c(arguments)}catch(a){return void d.onError(a)}d.onNext(b)})}).publish().refCount()},Ta.fromEventPattern=function(a,b,c){return new jb(function(d){function e(a){var b=a;if(c)try{b=c(arguments)}catch(a){return void d.onError(a)}d.onNext(b)}var f=a(e);return ta(function(){b&&b(e,f)})}).publish().refCount()};var db=Ta.fromPromise=function(a){return new jb(function(b){return a.then(function(a){b.onNext(a),b.onCompleted()},function(a){b.onError(a)}),function(){a&&a.abort&&a.abort()}})};Qa.toPromise=function(a){if(a||(a=F.config.Promise),!a)throw new Error("Promise type not provided nor in Rx.config.Promise");var b=this;return new a(function(a,c){var d,e=!1;b.subscribe(function(a){d=a,e=!0},function(a){c(a)},function(){e&&a(d)})})},Ta.startAsync=function(a){var b;try{b=a()}catch(a){return $a(a)}return db(b)},Qa.multicast=function(a,b){var c=this;return"function"==typeof a?new jb(function(d){var e=c.multicast(a());return new qa(b(e).subscribe(d),e.connect())}):new eb(c,a)},Qa.publish=function(a){return a?this.multicast(function(){return new mb},a):this.multicast(new mb)},Qa.share=function(){return this.publish(null).refCount()},Qa.publishLast=function(a){return a?this.multicast(function(){return new nb},a):this.multicast(new nb)},Qa.publishValue=function(a,b){return 2===arguments.length?this.multicast(function(){return new pb(b)},a):this.multicast(new pb(a))},Qa.shareValue=function(a){return this.publishValue(a).refCount()},Qa.replay=function(a,b,c,d){return a?this.multicast(function(){return new qb(b,c,d)},a):this.multicast(new qb(b,c,d))},Qa.shareReplay=function(a,b,c){return this.replay(null,a,b,c).refCount()};var eb=F.ConnectableObservable=function(a){function b(b,c){function d(a){return e.subject.subscribe(a)}var e={subject:c,source:b.asObservable(),hasSubscription:!1,subscription:null};this.connect=function(){return e.hasSubscription||(e.hasSubscription=!0,e.subscription=new qa(e.source.subscribe(e.subject),ta(function(){e.hasSubscription=!1}))),e.subscription},a.call(this,d)}return la(b,a),b.prototype.connect=function(){return this.connect()},b.prototype.refCount=function(){var a=null,b=0,c=this;return new jb(function(d){var e,f;return b++,e=1===b,f=c.subscribe(d),e&&(a=c.connect()),ta(function(){f.dispose(),0===--b&&a.dispose()})})},b}(Ta),fb=Ta.interval=function(a,b){return b||(b=Fa),w(a,a,b)},gb=Ta.timer=function(a,b,c){var d;return c||(c=Fa),"number"==typeof b?d=b:"object"==typeof b&&"now"in b&&(c=b),d===e?v(a,c):w(a,d,c)};Qa.delay=function(a,b){b||(b=Fa);var c=this;return new jb(function(d){var e,f=!1,g=new xa,h=null,i=[],j=!1;return e=c.materialize().timestamp(b).subscribe(function(c){var e,k;"E"===c.value.kind?(i=[],i.push(c),h=c.value.exception,k=!j):(i.push({value:c.value,timestamp:c.timestamp+a}),k=!f,f=!0),k&&(null!==h?d.onError(h):(e=new wa,g.setDisposable(e),e.setDisposable(b.scheduleRecursiveWithRelative(a,function(a){var c,e,g,k;if(null===h){j=!0;do{g=null,i.length>0&&i[0].timestamp-b.now()<=0&&(g=i.shift().value),null!==g&&g.accept(d)}while(null!==g);k=!1,e=0,i.length>0?(k=!0,e=Math.max(0,i[0].timestamp-b.now())):f=!1,c=h,j=!1,null!==c?d.onError(c):k&&a(e)}}))))}),new qa(e,g)})},Qa.throttle=function(a,b){b||(b=Fa);return this.throttleWithSelector(function(){return gb(a,b)})},Qa.timeInterval=function(a){var b=this;return a||(a=Fa),Va(function(){var c=a.now();return b.select(function(b){var d=a.now(),e=d-c;return c=d,{value:b,interval:e}})})},Qa.timestamp=function(a){return a||(a=Fa),this.select(function(b){return{value:b,timestamp:a.now()}})},Qa.sample=function(a,b){return b||(b=Fa),"number"==typeof a?x(this,fb(a,b)):x(this,a)},Qa.timeout=function(a,b,c){var d,e=this;return b||(b=$a(new Error("Timeout"))),c||(c=Fa),d=a instanceof Date?function(a,b){c.scheduleWithAbsolute(a,b)}:function(a,b){c.scheduleWithRelative(a,b)},new jb(function(c){var f,g=0,h=new wa,i=new xa,j=!1,k=new xa;return i.setDisposable(h),f=function(){var e=g;k.setDisposable(d(a,function(){(j=g===e)&&i.setDisposable(b.subscribe(c))}))},f(),h.setDisposable(e.subscribe(function(a){!j&&(g++,c.onNext(a),f())},function(a){!j&&(g++,c.onError(a))},function(){!j&&(g++,c.onCompleted())})),new qa(i,k)})},Ta.generateWithRelativeTime=function(a,b,c,d,e,f){return f||(f=Fa),new jb(function(g){var h,i,j=!0,k=!1,l=a;return f.scheduleRecursiveWithRelative(0,function(a){k&&g.onNext(h);try{j?j=!1:l=c(l),k=b(l),k&&(h=d(l),i=e(l))}catch(a){return void g.onError(a)}k?a(i):g.onCompleted()})})},Qa.delaySubscription=function(a,b){return b||(b=Fa),this.delayWithSelector(gb(a,b),function(){return Wa()})},Qa.delayWithSelector=function(a,b){var c,d,e=this;return"function"==typeof a?d=a:(c=a,d=b),new jb(function(a){var b=new qa,f=!1,g=function(){f&&0===b.length&&a.onCompleted()},h=new xa,i=function(){h.setDisposable(e.subscribe(function(c){var e;try{e=d(c)}catch(b){return void a.onError(b)}var f=new wa;b.add(f),f.setDisposable(e.subscribe(function(){a.onNext(c),b.remove(f),g()},a.onError.bind(a),function(){a.onNext(c),b.remove(f),g()}))},a.onError.bind(a),function(){f=!0,h.dispose(),g()}))};return c?h.setDisposable(c.subscribe(function(){i()},a.onError.bind(a),function(){i()})):i(),new qa(h,b)})},Qa.timeoutWithSelector=function(a,b,c){if(1===arguments.length){b=a;var a=Ya()}c||(c=$a(new Error("Timeout")));var d=this;return new jb(function(e){var f=new xa,g=new xa,h=new wa;f.setDisposable(h);var i=0,j=!1,k=function(a){var b=i,d=function(){return i===b},h=new wa;g.setDisposable(h),h.setDisposable(a.subscribe(function(){d()&&f.setDisposable(c.subscribe(e)),h.dispose()},function(a){d()&&e.onError(a)},function(){d()&&f.setDisposable(c.subscribe(e))}))};k(a);var l=function(){var a=!j;return a&&i++,a};return h.setDisposable(d.subscribe(function(a){if(l()){e.onNext(a);var c;try{c=b(a)}catch(a){return void e.onError(a)}k(c)}},function(a){l()&&e.onError(a)},function(){l()&&e.onCompleted()})),new qa(f,g)})},Qa.throttleWithSelector=function(a){var b=this;return new jb(function(c){var d,e=!1,f=new xa,g=0,h=b.subscribe(function(b){var h;try{h=a(b)}catch(a){return void c.onError(a)}e=!0,d=b,g++;var i=g,j=new wa;f.setDisposable(j),j.setDisposable(h.subscribe(function(){e&&g===i&&c.onNext(d),e=!1,j.dispose()},c.onError.bind(c),function(){e&&g===i&&c.onNext(d),e=!1,j.dispose()}))},function(a){f.dispose(),c.onError(a),e=!1,g++},function(){f.dispose(),e&&c.onNext(d),c.onCompleted(),e=!1,g++});return new qa(h,f)})},Qa.skipLastWithTime=function(a,b){b||(b=Fa);var c=this;return new jb(function(d){var e=[];return c.subscribe(function(c){var f=b.now();for(e.push({interval:f,value:c});e.length>0&&f-e[0].interval>=a;)d.onNext(e.shift().value)},d.onError.bind(d),function(){for(var c=b.now();e.length>0&&c-e[0].interval>=a;)d.onNext(e.shift().value);d.onCompleted()})})},Qa.takeLastWithTime=function(a,b,c){return this.takeLastBufferWithTime(a,b).selectMany(function(a){return Xa(a,c)})},Qa.takeLastBufferWithTime=function(a,b){var c=this;return b||(b=Fa),new jb(function(d){var e=[];return c.subscribe(function(c){var d=b.now();for(e.push({interval:d,value:c});e.length>0&&d-e[0].interval>=a;)e.shift()},d.onError.bind(d),function(){for(var c=b.now(),f=[];e.length>0;){var g=e.shift();c-g.interval<=a&&f.push(g.value)}d.onNext(f),d.onCompleted()})})},Qa.takeWithTime=function(a,b){var c=this;return b||(b=Fa),new jb(function(d){var e=b.scheduleWithRelative(a,function(){d.onCompleted()});return new qa(e,c.subscribe(d))})},Qa.skipWithTime=function(a,b){var c=this;return b||(b=Fa),new jb(function(d){var e=!1,f=b.scheduleWithRelative(a,function(){e=!0}),g=c.subscribe(function(a){e&&d.onNext(a)},d.onError.bind(d),d.onCompleted.bind(d));return new qa(f,g)})},Qa.skipUntilWithTime=function(a,b){b||(b=Fa);var c=this;return new jb(function(d){var e=!1,f=b.scheduleWithAbsolute(a,function(){e=!0}),g=c.subscribe(function(a){e&&d.onNext(a)},d.onError.bind(d),d.onCompleted.bind(d));return new qa(f,g)})},Qa.takeUntilWithTime=function(a,b){b||(b=Fa);var c=this;return new jb(function(d){return new qa(b.scheduleWithAbsolute(a,function(){d.onCompleted()}),c.subscribe(d))})},Qa.pausable=function(a){var b=this;return new jb(function(c){var d=b.publish(),e=d.subscribe(c),f=ua,g=a.distinctUntilChanged().subscribe(function(a){a?f=d.connect():(f.dispose(),f=ua)});return new qa(e,f,g)})},Qa.pausableBuffered=function(a){var b=this;return new jb(function(c){var d=[],e=!0,f=y(b,a.distinctUntilChanged(),function(a,b){return{data:a,shouldFire:b}}).subscribe(function(a){if(a.shouldFire&&e&&c.onNext(a.data),a.shouldFire&&!e){for(;d.length>0;)c.onNext(d.shift());e=!0}else a.shouldFire||e?!a.shouldFire&&e&&(e=!1):d.push(a.data)},c.onError.bind(c),c.onCompleted.bind(c));return a.onNext(!1),f})},Qa.controlled=function(a){return null==a&&(a=!0),new hb(this,a)};var hb=function(a){function b(a){return this.source.subscribe(a)}function c(c,d){a.call(this,b),this.subject=new ib(d),this.source=c.multicast(this.subject).refCount()}return la(c,a),c.prototype.request=function(a){return null==a&&(a=-1),this.subject.request(a)},c}(Ta),ib=F.ControlledSubject=function(a){function b(a){return this.subject.subscribe(a)}function c(c){null==c&&(c=!0),a.call(this,b),this.subject=new mb,this.enableQueue=c,this.queue=c?[]:null,this.requestedCount=0,this.requestedDisposable=ua,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.controlledDisposable=ua}return la(c,a),ma(c.prototype,Oa,{onCompleted:function(){f.call(this),this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length||this.subject.onCompleted()},onError:function(a){f.call(this),this.hasFailed=!0,this.error=a,this.enableQueue&&0!==this.queue.length||this.subject.onError(a)},onNext:function(a){f.call(this);var b=!1;0===this.requestedCount?this.enableQueue&&this.queue.push(a):(-1!==this.requestedCount&&0==this.requestedCount--&&this.disposeCurrentRequest(),b=!0),b&&this.subject.onNext(a)},_processRequest:function(a){if(this.enableQueue){for(;this.queue.length>=a&&a>0;)this.subject.onNext(this.queue.shift()),a--;return 0!==this.queue.length?{numberOfItems:a,returnValue:!0}:{numberOfItems:a,returnValue:!1}}return this.hasFailed?(this.subject.onError(this.error),this.controlledDisposable.dispose(),this.controlledDisposable=ua):this.hasCompleted&&(this.subject.onCompleted(),this.controlledDisposable.dispose(),this.controlledDisposable=ua),{numberOfItems:a,returnValue:!1}},request:function(a){f.call(this),this.disposeCurrentRequest();var b=this,c=this._processRequest(a);return a=c.numberOfItems,c.returnValue?ua:(this.requestedCount=a,this.requestedDisposable=ta(function(){b.requestedCount=0}),this.requestedDisposable)},disposeCurrentRequest:function(){this.requestedDisposable.dispose(),this.requestedDisposable=ua},dispose:function(){this.isDisposed=!0,this.error=null,this.subject.dispose(),this.requestedDisposable.dispose()}}),c}(Ta),jb=F.AnonymousObservable=function(a){function b(a){return void 0===a?a=ua:"function"==typeof a&&(a=ta(a)),a}function c(d){function e(a){var c=new kb(a);if(Da.scheduleRequired())Da.schedule(function(){try{c.setDisposable(b(d(c)))}catch(a){if(!c.fail(a))throw a}});else try{c.setDisposable(b(d(c)))}catch(a){if(!c.fail(a))throw a}return c}if(!(this instanceof c))return new c(d);a.call(this,e)}return la(c,a),c}(Ta),kb=function(a){function b(b){a.call(this),this.observer=b,this.m=new wa}la(b,a);var c=b.prototype;return c.next=function(a){var b=!1;try{this.observer.onNext(a),b=!0}catch(a){throw a}finally{b||this.dispose()}},c.error=function(a){try{this.observer.onError(a)}catch(a){throw a}finally{this.dispose()}},c.completed=function(){try{this.observer.onCompleted()}catch(a){throw a}finally{this.dispose()}},c.setDisposable=function(a){this.m.setDisposable(a)},c.getDisposable=function(a){return this.m.getDisposable()},c.disposable=function(a){return arguments.length?this.getDisposable():setDisposable(a)},c.dispose=function(){a.prototype.dispose.call(this),this.m.dispose()},b}(Ra),lb=function(a,b){this.subject=a,this.observer=b};lb.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1),this.observer=null}};var mb=F.Subject=function(a){function b(a){return f.call(this),this.isStopped?this.exception?(a.onError(this.exception),ua):(a.onCompleted(),ua):(this.observers.push(a),new lb(this,a))}function c(){a.call(this,b),this.isDisposed=!1,this.isStopped=!1,this.observers=[]}return la(c,a),ma(c.prototype,Oa,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(f.call(this),!this.isStopped){var a=this.observers.slice(0);this.isStopped=!0;for(var b=0,c=a.length;b<c;b++)a[b].onCompleted();this.observers=[]}},onError:function(a){if(f.call(this),!this.isStopped){var b=this.observers.slice(0);this.isStopped=!0,this.exception=a;for(var c=0,d=b.length;c<d;c++)b[c].onError(a);this.observers=[]}},onNext:function(a){if(f.call(this),!this.isStopped)for(var b=this.observers.slice(0),c=0,d=b.length;c<d;c++)b[c].onNext(a)},dispose:function(){this.isDisposed=!0,this.observers=null}}),c.create=function(a,b){return new ob(a,b)},c}(Ta),nb=F.AsyncSubject=function(a){function b(a){if(f.call(this),!this.isStopped)return this.observers.push(a),new lb(this,a);var b=this.exception,c=this.hasValue,d=this.value;return b?a.onError(b):c?(a.onNext(d),a.onCompleted()):a.onCompleted(),ua}function c(){a.call(this,b),this.isDisposed=!1,this.isStopped=!1,this.value=null,this.hasValue=!1,this.observers=[],this.exception=null}return la(c,a),ma(c.prototype,Oa,{hasObservers:function(){return f.call(this),this.observers.length>0},onCompleted:function(){var a,b,c;if(f.call(this),!this.isStopped){this.isStopped=!0;var d=this.observers.slice(0),e=this.value;if(this.hasValue)for(b=0,c=d.length;b<c;b++)a=d[b],a.onNext(e),a.onCompleted();else for(b=0,c=d.length;b<c;b++)d[b].onCompleted();this.observers=[]}},onError:function(a){if(f.call(this),!this.isStopped){var b=this.observers.slice(0);this.isStopped=!0,this.exception=a;for(var c=0,d=b.length;c<d;c++)b[c].onError(a);this.observers=[]}},onNext:function(a){f.call(this),this.isStopped||(this.value=a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.exception=null,this.value=null}}),c}(Ta),ob=function(a){function b(a){return this.observable.subscribe(a)}function c(c,d){a.call(this,b),this.observer=c,this.observable=d}return la(c,a),ma(c.prototype,Oa,{onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},onNext:function(a){this.observer.onNext(a)}}),c}(Ta),pb=F.BehaviorSubject=function(a){function b(a){if(f.call(this),!this.isStopped)return this.observers.push(a),a.onNext(this.value),new lb(this,a);var b=this.exception;return b?a.onError(b):a.onCompleted(),ua}function c(c){a.call(this,b),this.value=c,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.exception=null}return la(c,a),ma(c.prototype,Oa,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(f.call(this),!this.isStopped){var a=this.observers.slice(0);this.isStopped=!0;for(var b=0,c=a.length;b<c;b++)a[b].onCompleted();this.observers=[]}},onError:function(a){if(f.call(this),!this.isStopped){var b=this.observers.slice(0);this.isStopped=!0,this.exception=a;for(var c=0,d=b.length;c<d;c++)b[c].onError(a);this.observers=[]}},onNext:function(a){if(f.call(this),!this.isStopped){this.value=a;for(var b=this.observers.slice(0),c=0,d=b.length;c<d;c++)b[c].onNext(a)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.exception=null}}),c}(Ta),qb=F.ReplaySubject=function(a){function b(a,b){this.subject=a,this.observer=b}function c(a){var c=new Ua(this.scheduler,a),d=new b(this,c);f.call(this),this._trim(this.scheduler.now()),this.observers.push(c);for(var e=this.q.length,g=0,h=this.q.length;g<h;g++)c.onNext(this.q[g].value);return this.hasError?(e++,c.onError(this.error)):this.isStopped&&(e++,c.onCompleted()),c.ensureActive(e),d}function d(b,d,e){this.bufferSize=null==b?Number.MAX_VALUE:b,this.windowSize=null==d?Number.MAX_VALUE:d,this.scheduler=e||Da,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,a.call(this,c)}return b.prototype.dispose=function(){if(this.observer.dispose(),!this.subject.isDisposed){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1)}},la(d,a),ma(d.prototype,Oa,{hasObservers:function(){return this.observers.length>0},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){var b;if(f.call(this),!this.isStopped){var c=this.scheduler.now();this.q.push({interval:c,value:a}),this._trim(c);for(var d=this.observers.slice(0),e=0,g=d.length;e<g;e++)b=d[e],b.onNext(a),b.ensureActive()}},onError:function(a){var b;if(f.call(this),!this.isStopped){this.isStopped=!0,this.error=a,this.hasError=!0;var c=this.scheduler.now();this._trim(c);for(var d=this.observers.slice(0),e=0,g=d.length;e<g;e++)b=d[e],b.onError(a),b.ensureActive();this.observers=[]}},onCompleted:function(){var a;if(f.call(this),!this.isStopped){this.isStopped=!0;var b=this.scheduler.now();this._trim(b);for(var c=this.observers.slice(0),d=0,e=c.length;d<e;d++)a=c[d],a.onCompleted(),a.ensureActive();this.observers=[]}},dispose:function(){this.isDisposed=!0,this.observers=null}}),d}(Ta);"function"==typeof define&&"object"==typeof define.amd&&define.amd?(A.Rx=F,define(function(){return F})):B&&C?D?(C.exports=F).Rx=F:B.Rx=F:A.Rx=F}).call(this)}(a("__browserify_process"),window)},{__browserify_process:34}],29:[function(a,b,c){!function(a,b,c){function d(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function e(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return q[a.which]?q[a.which]:r[a.which]?r[a.which]:String.fromCharCode(a.which).toLowerCase()}function f(a){a=a||{};var b,c=!1;for(b in w)a[b]?c=!0:w[b]=0;c||(z=!1)}function g(a,b,c,d,e,f){var g,h,i=[],j=c.type;if(!u[a])return[];for("keyup"==j&&k(a)&&(b=[a]),g=0;g<u[a].length;++g)if(h=u[a][g],!(!d&&h.seq&&w[h.seq]!=h.level||j!=h.action||("keypress"!=j||c.metaKey||c.ctrlKey)&&b.sort().join(",")!==h.modifiers.sort().join(","))){var l=d&&h.seq==d&&h.level==f;(!d&&h.combo==e||l)&&u[a].splice(g,1),i.push(h)}return i}function h(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function i(a,b,c,d){A.stopCallback(b,b.target||b.srcElement,c,d)||!1!==a(b,c)||(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0)}function j(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=e(a);b&&("keyup"==a.type&&x===b?x=!1:A.handleKey(b,h(a),a))}function k(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function l(a,b,c,d){function g(b){return function(){z=b,++w[a],clearTimeout(p),p=setTimeout(f,1e3)}}function h(b){i(c,b,a),"keyup"!==d&&(x=e(b)),setTimeout(f,10)}for(var j=w[a]=0;j<b.length;++j){var k=j+1===b.length?h:g(d||m(b[j+1]).action);n(b[j],k,d,a,j)}}function m(a,b){var c,d,e,f=[];for(c="+"===a?["+"]:a.split("+"),e=0;e<c.length;++e)d=c[e],t[d]&&(d=t[d]),b&&"keypress"!=b&&s[d]&&(d=s[d],f.push("shift")),k(d)&&f.push(d);if(c=d,!(e=b)){if(!o){o={};for(var g in q)95<g&&112>g||q.hasOwnProperty(g)&&(o[q[g]]=g)}e=o[c]?"keydown":"keypress"}return"keypress"==e&&f.length&&(e="keydown"),{key:d,modifiers:f,action:e}}function n(a,b,c,d,e){v[a+":"+c]=b,a=a.replace(/\s+/g," ");var f=a.split(" ");1<f.length?l(a,f,b,c):(c=m(a,c),u[c.key]=u[c.key]||[],g(c.key,c.modifiers,{type:c.action},d,a,e),u[c.key][d?"unshift":"push"]({callback:b,modifiers:c.modifiers,action:c.action,seq:d,level:e,combo:a}))}var o,p,q={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},t={option:"alt",command:"meta",return:"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},u={},v={},w={},x=!1,y=!1,z=!1;for(c=1;20>c;++c)q[111+c]="f"+c;for(c=0;9>=c;++c)q[c+96]=c;d(b,"keypress",j),d(b,"keydown",j),d(b,"keyup",j);var A={bind:function(a,b,c){a=a instanceof Array?a:[a];for(var d=0;d<a.length;++d)n(a[d],b,c);return this},unbind:function(a,b){return A.bind(a,function(){},b)},trigger:function(a,b){return v[a+":"+b]&&v[a+":"+b]({},a),this},reset:function(){return u={},v={},this},stopCallback:function(a,b){return!(-1<(" "+b.className+" ").indexOf(" mousetrap "))&&("INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable)},handleKey:function(a,b,c){var d,e=g(a,b,c);b={};var h=0,j=!1;for(d=0;d<e.length;++d)e[d].seq&&(h=Math.max(h,e[d].level));for(d=0;d<e.length;++d)e[d].seq?e[d].level==h&&(j=!0,b[e[d].seq]=1,i(e[d].callback,c,e[d].combo,e[d].seq)):j||i(e[d].callback,c,e[d].combo);e="keypress"==c.type&&y,c.type!=z||k(a)||e||f(b),y=j&&"keydown"==c.type}};a.Mousetrap=A,"function"==typeof define&&define.amd&&define(A)}(window,document)},{}],31:[function(a,b,c){var d=function(a,b){this.remove=function(){a.zoomOut()},this.execute=function(){return a.zoomIn(),{X:a.zoomX,Y:a.zoomY}}},e=function(a,b){this.remove=function(){a.zoomIn()},this.execute=function(){return a.zoomOut(),{X:a.zoomX,Y:a.zoomY}}};b.exports={zoomIn:d,zoomOut:e}},{}],33:[function(a,b,c){var d=function(a,b){var b=b||{figure:$('input[name="figure"]:last').val()};this.remove=function(){this.figure.visible(!0),this.figure.isVisible=!0;for(i in this.figure.ancestors)this.figure.ancestors.hasOwnProperty(i)&&(this.figure.ancestors[i].visible(!0),this.figure.ancestors[i].isVisible=!0)},this.execute=function(){for(var c=0;c<a.shapes.length;c++)if(a.shapes[c].name==b.figure){a.shapes[c].visible(!1),this.figure=a.shapes[c],this.figure.isVisible=!1;for(c in this.figure.ancestors)this.figure.ancestors[c].visible(!1),this.figure.ancestors[c].isVisible=!1}if(void 0===this.figure)for(p in a.points)a.points.hasOwnProperty(p)&&a.points[p].name+"0"==b.figure&&(this.figure=a.points[p],this.figure.isVisible=!1,this.figure.visible(!1));if(void 0===this.figure)throw ReferenceError("Could not find figure '"+b.figure+"'");return b}};b.exports={delete_:d}},{}],23:[function(a,b,c){var d=a("../board/functions/lexer");b.exports=function(){var a=Object.freeze({coord:"A coordinate must be an ordered pair separated by a comma",radius:"A radius here must be a positive number",pixel:"A size in pixels is defined by a positive number",text:"",point:"A point is a single uppercase letter that identifies a defined point on the plane",axis:"An axis must be either 'X' or 'Y', case-sensitive",figure:"A figure should begin with an uppercase letter and an integer",value:"A value is an ordered pair e.g. 'x,y', similar to coordinates",degrees:"Here a degrees must always be a positive number"});$(document).on("focusout keyup","[data-type]",function(){var b,c,e=$(this).val(),f=$(this).attr("data-type");switch(f){case"coord":case"value":-1===e.indexOf(",")&&(b=a[f]),e=e.split(","),$.isNumeric(e[0])&&$.isNumeric(e[1])||(b=a[f]);break;case"radius":case"pixel":case"degrees":(parseInt(e)<0||!$.isNumeric(e))&&(b=a[f]);break;case"axis":"X"!==e&&"Y"!==e&&(b=a[f]);break;case"point":c=new d(e);var g=[c.getNextToken(),c.getNextToken()];4==g[0]&&12==g[1]||(b=a[f]);break;case"figure":c=new d(e),console.log(c);var g=[c.getNextToken(),c.getNextToken()];10==g[0]&&12==g[1]||(b=a[f])}void 0!==b?($(this).attr("data-error",b),b=void 0):$(this).removeAttr("data-error")})}},{"../board/functions/lexer":35}],26:[function(a,b,c){var d=a("./lexer"),e=function(a){this.llex=new d(a),this._arguments=[],this._identifier,Object.defineProperty(this,"arguments",{get:function(){return this._arguments}}),Object.defineProperty(this,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(this,"object",{get:function(){return{identifier:this._identifier,arguments:this._arguments}}})};e.prototype=function(){var a=Object.freeze({T_UNKNOWN:1,T_INTEGER:2,T_FLOAT:3,T_LETTER:4,T_OPEN_PAREN:5,T_CLOSE_PAREN:6,T_COMMA:7,T_IDENTIFIER:8,T_EQUAL:9,T_LABEL:10,T_EXPR:11,T_EOL:12}),b=Object.freeze({1:"unknown",2:"integer",3:"float",4:"letter",5:"(",6:")",7:",",8:"identifier",9:"=",10:"label",11:"expression",12:"EOL"}),c=function(a,c,d){d instanceof Array&&(d=d[0]);var e="unknown"==b[c]?a.scanner:b[c],f=["Unexpected token: '",e,"', expected ",b[d]].join("");throw new Error(f)},d=function(a){if(this.llex.getNextToken(),a instanceof Array){var b=!1,d=this.llex;if(a.forEach(function(a){a==d.current_token&&(b=!0)}),!b)return c(this.llex,this.llex.current_token,a),!1}else if(this.llex.current_token!==a)return c(this.llex,this.llex.current_token,a),!1;return this.llex.current_token};return{Constructor:e,run:function(){if("="==this.llex.expr[this.llex.pointer]&&d.call(this,a.T_EQUAL),d.call(this,[a.T_EXPR,a.T_IDENTIFIER]),this.llex.current_token==a.T_EXPR)this._arguments.push({argument:this.llex.scanner,type:b[a.T_EXPR]});else{this._identifier=this.llex.scanner,d.call(this,[a.T_OPEN_PAREN]);var c;do{c=d.call(this,[a.T_LABEL,a.T_LETTER,a.T_INTEGER,a.T_FLOAT]),this._arguments.push({argument:this.llex.scanner,type:b[c]})}while(d.call(this,[a.T_COMMA,a.T_CLOSE_PAREN])==a.T_COMMA)}d.call(this,a.T_EOL)}}}(),b.exports=e},{"./lexer":35}],28:[function(a,b,c){var d=a("../board/transform"),e=(a("../helper/coords")(),function(a,b){var b=b||{figure:$('input[name="figure"]:last').val(),center:$('input[name="point"]:last').val(),degrees:parseInt($('input[name="degrees"]:last').val())},c=this.points={},e={};for(arg in b)b.hasOwnProperty(arg)&&(e[arg]=b[arg]);e.points=[],a.shapes.forEach(function(a){a.name==e.figure&&(e.points=a.usrSetCoords)}),delete e.figure,this.rotate=new d(a,"rotate",e),this.remove=function(){for(p in this.points)this.points.hasOwnProperty(p)&&(a.points[p].update(),a.points[p].setPosition(JXG.COORDS_BY_USER,this.points[p]),a.update())},this.execute=function(){return e.points.forEach(function(b){Object.defineProperty(c,b.name,{value:[a.points[b.name].coords.usrCoords[1],a.points[b.name].coords.usrCoords[2]],enumerable:!0})}),this.rotate.apply(),b}}),f=function(a,b){var b=b||{figure:$('input[name="figure"]:last').val(),line:$('input[name="axis"]:last').val()},c=this.points={},e={};for(arg in b)b.hasOwnProperty(arg)&&(e[arg]=b[arg]);if(this.line=e.line,e.points=[],"x"==e.line.toLowerCase()?e.line=a.axx:e.line=a.axy,a.shapes.forEach(function(a){a.name==e.figure&&(e.points=a.usrSetCoords)}),!e.points.length)for(p in a.points)a.points.hasOwnProperty(p)&&a.points[p].name+"0"==e.figure&&(e.points=[a.points[p]]);delete e.figure,this.reflect=new d(a,"reflect",e),this.remove=function(){for(p in this.points)this.points.hasOwnProperty(p)&&(a.points[p].setPosition(JXG.COORDS_BY_USER,this.points[p]),a.update())},this.execute=function(){return e.points.forEach(function(b){Object.defineProperty(c,b.name,{value:[a.points[b.name].coords.usrCoords[1],a.points[b.name].coords.usrCoords[2]],enumerable:!0})}),this.reflect.apply(),b}},g=function(a,b){var b=b||{figure:$('input[name="figure"]:last').val(),degrees:parseInt($('input[name="degrees"]:last').val())},c=this.points={},e={};for(arg in b)b.hasOwnProperty(arg)&&(e[arg]=b[arg]);e.points=[],a.shapes.forEach(function(a){a.name==e.figure&&(e.points=a.usrSetCoords)}),delete e.figure,this.shear=new d(a,"shear",e),this.remove=function(){for(p in this.points)this.points.hasOwnProperty(p)&&(a.points[p].setPosition(JXG.COORDS_BY_USER,this.points[p]),a.update())},this.execute=function(){return e.points.forEach(function(b){Object.defineProperty(c,b.name,{value:[a.points[b.name].coords.usrCoords[1],a.points[b.name].coords.usrCoords[2]],enumerable:!0})}),this.shear.apply(),b}},h=function(a,b){var b=b||{figure:$('input[name="figure"]:last').val(),values:$('input[name="values"]:last').coord()},c=this.points={},e={};for(arg in b)b.hasOwnProperty(arg)&&(e[arg]=b[arg]);if(e.points=[],a.shapes.forEach(function(a){a.name==e.figure&&(e.points=a.usrSetCoords)}),!e.points.length)for(p in a.points)a.points.hasOwnProperty(p)&&a.points[p].name+"0"==e.figure&&(e.points=[a.points[p]]);delete e.figure,this.translate=new d(a,"translate",e),this.remove=function(){for(p in this.points)this.points.hasOwnProperty(p)&&(a.points[p].setPosition(JXG.COORDS_BY_USER,this.points[p]),a.update())},this.execute=function(){return e.points.forEach(function(b){Object.defineProperty(c,b.name,{value:[a.points[b.name].coords.usrCoords[1],a.points[b.name].coords.usrCoords[2]],enumerable:!0})}),this.translate.apply(),b}},i=function(a,b){var b=b,c=this.points={},e={};for(arg in b)b.hasOwnProperty(arg)&&(e[arg]=b[arg]);e=$.extend(!0,{},b),e.points=[],a.shapes.forEach(function(a){a.name==e.figure&&(e.points=a.usrSetCoords)}),this.initial||(this.initial=e.initial),e.points.length||e.points.push(a.points[e.figure]),delete e.figure,delete e.initial,this.translate=new d(a,"translate",e),this.apply=function(b,c){var d,e,f;for(!b instanceof Array&&(b=[b]),e=b.length,f=0;f<e;f++)d=c.pop(),b[f].moveTo(d),a.update()},this.remove=function(){this.apply(e.points,this.initial)},this.execute=function(){return e.points.forEach(function(b){Object.defineProperty(c,b.name,{value:[a.points[b.name].coords.usrCoords[1],a.points[b.name].coords.usrCoords[2]],enumerable:!0})}),this.translate.apply(),b}},j=function(a,b){var b=b||{figure:$('input[name="figure"]:last').val(),values:$('input[name="values"]:last').coord()},c=this.points={},e={};for(arg in b)b.hasOwnProperty(arg)&&(e[arg]=b[arg]);e.points=[],a.shapes.forEach(function(a){a.name==e.figure&&(e.points=a.usrSetCoords)}),delete e.figure,this.scale=new d(a,"scale",e),this.remove=function(){for(p in this.points)this.points.hasOwnProperty(p)&&(a.points[p].setPosition(JXG.COORDS_BY_USER,this.points[p]),a.update())},this.execute=function(){return e.points.forEach(function(b){Object.defineProperty(c,b.name,{value:[a.points[b.name].coords.usrCoords[1],a.points[b.name].coords.usrCoords[2]],enumerable:!0})}),this.scale.apply(),b}};b.exports={rotate:e,reflect:f,shear:g,drag:i,translate:h,scale:j}},{"../board/transform":36,"../helper/coords":37}],30:[function(a,b,c){var d=a("../board/element"),e=(a("../helper/coords")(),function(a,b){var b=b||{center:$('input[name="center"]:last').coord(),radius:parseFloat($('input[name="radius"]:last').val())};this.circle=new d(a,"circle",b),this.remove=function(){delete a.points[this.circleElement.center.name],a.removeObject(this.circleElement.center),a.removeObject(this.circleElement),a.shapes.pop()},this.execute=function(){return this.circleElement=this.circle.draw(),b}}),f=function(a,b){var b=b||{point1:$('input[name="point1"]:last').coord(),point2:$('input[name="point2"]:last').coord(),point3:$('input[name="point3"]:last').coord()};this.angle=new d(a,"angle",b),this.remove=function(){delete a.points[this.angleElement.point1.name],delete a.points[this.angleElement.point2.name],delete a.points[this.angleElement.point3.name],a.removeObject(this.angleElement.point1),a.removeObject(this.angleElement.point2),a.removeObject(this.angleElement.point3),a.removeObject(this.angleElement),a.shapes.pop()},this.execute=function(){return this.angleElement=this.angle.draw(),b}},g=function(a,b){var b=b||{point1:$('input[name="point1"]:last').coord(),point2:$('input[name="point2"]:last').coord(),point3:$('input[name="point3"]:last').coord()};this.arc=new d(a,"arc",b),this.remove=function(){delete a.points[this.arcElement.center.name],delete a.points[this.arcElement.point2.name],delete a.points[this.arcElement.point3.name],a.removeObject(this.arcElement.center),a.removeObject(this.arcElement.point2),a.removeObject(this.arcElement.point3),a.removeObject(this.arcElement),a.shapes.pop()},this.execute=function(){return this.arcElement=this.arc.draw(),b}},h=function(a,b){var b=b||{point1:$('input[name="point1"]:last').coord(),point2:$('input[name="point2"]:last').coord(),point3:$('input[name="point3"]:last').coord()};this.ellipse=new d(a,"ellipse",b),this.remove=function(){var b=a.shapes.pop();a.removeObject(b.usrSetCoords[0]),a.removeObject(b.usrSetCoords[1]),a.removeObject(b.usrSetCoords[2]),a.removeObject(this.ellipseElement)},this.execute=function(){return this.ellipseElement=this.ellipse.draw(),b}},i=function(a,b){var b=b||{point1:$('input[name="point1"]:last').coord(),point2:$('input[name="point2"]:last').coord()};this.segment=new d(a,"segment",b),this.remove=function(){delete a.points[this.segmentElement.point1.name],delete a.points[this.segmentElement.point2.name],a.removeObject(this.segmentElement.point1),a.removeObject(this.segmentElement.point2),a.removeObject(this.segmentElement),a.shapes.pop()},this.execute=function(){return this.segmentElement=this.segment.draw(),b}},j=function(a,b){var b=b||{point1:$('input[name="point1"]:last').coord(),point2:$('input[name="point2"]:last').coord()};this.line=new d(a,"line",b),this.remove=function(){delete a.points[this.lineElement.point1.name],delete a.points[this.lineElement.point2.name],a.removeObject(this.lineElement.point1),a.removeObject(this.lineElement.point2),a.removeObject(this.lineElement),a.shapes.pop()},this.execute=function(){return this.lineElement=this.line.draw(),b}},k=function(a,b){var c={};$(".draw-polygon:last input").each(function(a,b){c["point"+a]=$(b).coord()}),b=b||c,this.polygon=new d(a,"polygon",b),this.remove=function(){this.polygonElement.vertices.pop(),this.polygonElement.vertices.forEach(function(b){delete a.points[b.name],a.removeObject(b)}),a.removeObject(this.polygonElement),a.shapes.pop()},this.execute=function(){return this.polygonElement=this.polygon.draw(),b}},l=function(a,b){var b=b||{point:$('input[name="point"]:last').coord()};this.point=new d(a,"point",b),this.remove=function(){delete a.points[this.pointElement.name],a.removeObject(this.pointElement)},this.execute=function(){return this.pointElement=this.point.draw(),b}},m=function(a,b){var b=b||{position:$('input[name="position"]:last').coord(),size:parseInt($('input[name="size"]:last').val()),text:$('input[name="text"]:last').val()};this.text=new d(a,"text",b),this.remove=function(){a.removeObject(this.textElement),a.shapes.pop()},this.execute=function(){return this.textElement=this.text.draw(),b}};b.exports={circle:e,angle:f,arc:g,ellipse:h,segment:i,line:j,polygon:k,point:l,text:m}},{"../board/element":38,"../helper/coords":37}],32:[function(a,b,c){var d=a("../board/functions/functions"),e=a("../board/functions/parser"),f=a("../board/element"),g=function(a,b){var c=function(a){return 180/Math.PI*a};if(void 0===b){var g=new e($("input.function").val());if(g.run(),3!=g.arguments.length)throw new SyntaxError("requires 3 points");var h="";if(!g.arguments.every(function(a){return"letter"==a.type}))throw new SyntaxError("invalid argument types");b=g.arguments}else void 0!==b.args&&(b=b.args);var h=b.map(function(a){return a.argument}).join(""),i=(this.args||b).map(function(b){return a.points[b.argument]});this.func=new d(JXG,"angle",i),this.execute=function(){var d=this.func.run(),e=(d.toFixed(2),c(d).toFixed(2));return this.textElement=new f(a,"text",{position:[i[1].coords.usrCoords[1],i[1].coords.usrCoords[2]-2],size:20,text:""+h+": "+parseFloat(e)+""}).draw(),b},this.remove=function(){a.removeObject(this.textElement),a.shapes.pop()}},h=function(a,b){var c;if(void 0===b){if(c=new e($("input.function").val()),c.run(),1!=c.arguments.length)throw new SyntaxError("requires 1 argument");b=c.arguments}else void 0!==b.args&&(b=b.args);var d,f=b[0].argument;if(a.shapes.forEach(function(a){a.name===f&&(d=a)}),!d)throw new ReferenceError("structure not found");if(d.vertices)return j.apply(this,arguments);if(d.radius)return i.apply(this,arguments);throw new Error("unrecognized structure to compute area")},i=function(a,b){if(void 0===b){var c=new e($("input.function").val());if(c.run(),1!=c.arguments.length)throw new SyntaxError("requires 1 argument");if(!c.arguments.every(function(a){return"label"==a.type}))throw new SyntaxError("invalid argument type");b=c.arguments}else void 0!==b.args&&(b=b.args);var g,h,i=b.map(function(a){return a.argument}).join("");if(a.shapes.forEach(function(a){a.name===i&&(h=a)}),void 0===h)throw new ReferenceError("structure "+i+" does not exist");if(void 0===h.radius)throw new ReferenceError("structure "+i+" is not a circle");g={radius:h.radius},this.func=new d(JXG,"circle_area",g),this.execute=function(){var c=this.func.run();return this.textElement=new f(a,"text",{position:[h.center.coords.usrCoords[1],h.center.coords.usrCoords[2]-2],size:18,text:"Area: "+c.toFixed(2)}).draw(),b},this.remove=function(){a.removeObject(this.textElement),a.shapes.pop()}},j=function(a,b){if(void 0===b){var c=new e($("input.function").val());if(c.run(),1!=c.arguments.length)throw new SyntaxError("requires 1 argument");if(!c.arguments.every(function(a){return"label"==a.type}))throw new SyntaxError("invalid argument type");b=c.arguments}else void 0!==b.args&&(b=b.args);var g,h=b.map(function(a){return a.argument}).join(""),i={};if(a.shapes.forEach(function(a){a.name===h&&(g=a)}),void 0===g)throw new ReferenceError("structure "+h+" does not exist");if(void 0===g.vertices)throw new ReferenceError("structure "+h+" is not a polygon");i.X=[],i.Y=[],i.vertices=0;var j=g.vertices.pop();g.vertices.forEach(function(a){i.X.push(a.coords.usrCoords[1]),i.Y.push(a.coords.usrCoords[2]),i.vertices++}),g.vertices.push(j),this.func=new d(JXG,"polygon_area",i),this.execute=function(){var c=this.func.run();return this.textElement=new f(a,"text",{position:[i.X[0]+5,i.Y[0]+1],size:18,text:"Area: "+parseFloat(c).toFixed(2)}).draw(),b},this.remove=function(){a.removeObject(this.textElement),a.shapes.pop()}},k=function(a,b){if(void 0===b){var c=new e($("input.function").val());if(c.run(),1!=c.arguments.length)throw new SyntaxError("requires 1 argument");b=c.arguments;b=b[0].argument}else void 0!==b.args&&(b=b.args);var g={equation:b,board:a};this.func=new d(JXG,"plot",g),this.execute=function(){try{var c=this.func.run()}catch(a){return alert("Expression Error: "+a.message),{failed:!0}}return this.functionElement=new f(a,"func",[c,function(){return new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],a).usrCoords[1]},function(){return new JXG.Coords(JXG.COORDS_BY_SCREEN,[a.canvasWidth,0],a).usrCoords[1]}]).draw(),b},this.remove=function(){a.removeObject(this.functionElement),a.shapes.pop()}};b.exports={angle:g,area:h,plot:k}},{"../board/functions/functions":39,"../board/functions/parser":26,"../board/element":38}],35:[function(a,b,c){var d=function(a){this.current_token,this.expr=a,this._pointer=0,this._scanner,Object.defineProperty(this,"scanner",{get:function(){return this._scanner}}),Object.defineProperty(this,"pointer",{get:function(){return this._pointer}})};d.prototype=function(){var a=Object.freeze({T_UNKNOWN:1,T_INTEGER:2,T_FLOAT:3,T_LETTER:4,T_OPEN_PAREN:5,T_CLOSE_PAREN:6,T_COMMA:7,T_IDENTIFIER:8,T_EQUAL:9,T_LABEL:10,T_EXPR:11,T_EOL:12}),b=function(){for(;/[\s\t\n]/.test(this.expr[this._pointer]);)this._pointer++};return{Constructor:d,getNextToken:function(){if(b.call(this),this._scanner=void 0,this._pointer>=this.expr.length)return this.current_token=a.T_EOL;if(/^.*?\bx\b.*?$/.test(this.expr))return this._scanner=this.expr,this._pointer=this._scanner.length,this.current_token=a.T_EXPR;if(/[a-z]/.test(this.expr[this._pointer])){for(this._scanner="";/[a-z]/.test(this.expr[this._pointer])&&!(this._pointer>=this.expr.length);)this._scanner+=this.expr[this._pointer],this._pointer++;return this.current_token=a.T_IDENTIFIER}if(/\(/.test(this.expr[this._pointer]))return this._pointer++,this.current_token=a.T_OPEN_PAREN;if(/\)/.test(this.expr[this._pointer]))return this._pointer++,this.current_token=a.T_CLOSE_PAREN;if(/,/.test(this.expr[this._pointer]))return this._pointer++,this.current_token=a.T_COMMA;if(/\=/.test(this.expr[this._pointer]))return this._pointer++,this.current_token=a.T_EQUAL;if(/[A-Z]/.test(this.expr[this._pointer])){var c;if(this._scanner=this.expr[this._pointer],this._pointer++,/[0-9]/.test(this.expr[this._pointer]))for(;/[0-9]/.test(this.expr[this._pointer])&&!(this._pointer>=this.expr.length);)c=a.T_LABEL,this._scanner+=this.expr[this._pointer],this._pointer++;return this.current_token=c||a.T_LETTER}if(/[0-9]/.test(this.expr[this._pointer])){this._scanner="";for(var c;/[0-9]/.test(this.expr[this._pointer])&&!(this._pointer>=this.expr.length);)if(this._scanner+=this.expr[this._pointer],this._pointer++,"."===this.expr[this._pointer]){if(c)return this._scanner=this.expr[this._pointer],this.current_token=a.T_UNKNOWN;this._scanner+=this.expr[this._pointer++],this.current_token=c=a.T_FLOAT}return this.current_token=c||a.T_INTEGER}return this._scanner=this.expr[this._pointer],this.current_token=a.T_UNKNOWN}}}(),b.exports=d},{}],36:[function(a,b,c){var d=function(a,b,c){return this.board=a,this.options=c,new this[b](a,c)};d.prototype=function(){var a=function(a){return Math.PI/180*a},b=function(a,b){this.options=b,this.board=a};b.prototype.apply=function(){this.board.create("transform",[a.call(this,this.options.degrees),this.options.center],{type:"rotate"}).applyOnce(this.options.points),this.board.update()};var c=function(a,b){this.options=b,this.board=a};c.prototype.apply=function(){this.board.create("transform",[this.options.line],{type:"reflect"}).applyOnce(this.options.points),this.board.update()};var e=function(a,b){this.options=b,this.board=a};e.prototype.apply=function(){this.board.create("transform",[a.call(this,this.options.degrees),0],{type:"shear"}).applyOnce(this.options.points),this.board.update()};var f=function(a,b){this.options=b,this.board=a};f.prototype.apply=function(){this.board.create("transform",this.options.values,{type:"translate"}).applyOnce(this.options.points),this.board.update()};var g=function(a,b){this.options=b,this.board=a};return g.prototype.apply=function(){this.board.create("transform",this.options.values.map(function(a){return a}),{type:"scale"}).applyOnce(this.options.points),this.board.update()},{Constructor:d,rotate:b,reflect:c,shear:e,translate:f,scale:g}}(),b.exports=d},{}],37:[function(a,b,c){b.exports=function(){jQuery.fn.coord=function(){if(this.val()&&-1!==this.val().indexOf(","))return this.val().split(",").map(function(a){return parseFloat(a)})}}},{}],39:[function(a,b,c){var d=function(a,b,c){return new this[b](a,c)};d.prototype=function(){var a=function(a,b){this.options=b,this.JXG=a};a.prototype.run=function(){return this.JXG.Math.Geometry.rad(this.options[0],this.options[1],this.options[2])};var b=function(a,b){this.options=b};b.prototype.run=function(){var a,b=0,c=this.options.vertices-1;for(a=0;a<this.options.vertices;a++)b+=(this.options.X[c]+this.options.X[a])*(this.options.Y[c]-this.options.Y[a]),c=a;return Math.abs(b/2)};var c=function(a,b){this.options=b};c.prototype.run=function(){return Math.PI*Math.pow(this.options.radius,2)};var e=function(a,b){this.options=b,this.jc=b.board.jc};return e.prototype.run=function(){return this.jc.snippet(this.options.equation,!0,"x,y",!0)},function(a,b){this.options=b}.prototype.run=function(){},function(a,b){this.options=b}.prototype.run=function(){},function(a,b){this.options=b}.prototype.run=function(){},{Constructor:d,angle:a,polygon_area:b,circle_area:c,plot:e}}(),b.exports=d},{}],38:[function(a,b,c){var d=a("./point"),e=a("./shape"),f=function(a,b,c){return this.element=b,this.options=c,new this[b](a,c)};f.prototype=function(){var a=function(a,b){this.options=b,this.board=a};a.prototype.draw=function(){var a=new d(this.board,this.options.center).add();return new e(this.board,"circle",[a,this.options.radius,[a]]).add()};var b=function(a,b){this.options=b,this.board=a};b.prototype.draw=function(){var a=new d(this.board,this.options.point1).add(),b=new d(this.board,this.options.point2).add(),c=new d(this.board,this.options.point3).add();return new e(this.board,"angle",[a,b,c,[a,b,c]]).add()};var c=function(a,b){this.options=b,this.board=a};c.prototype.draw=function(){var a=new d(this.board,this.options.point1).add(),b=new d(this.board,this.options.point2).add(),c=new d(this.board,this.options.point3).add();return new e(this.board,"arc",[a,b,c,[a,b,c]]).add()};var g=function(a,b){this.options=b,this.board=a};g.prototype.draw=function(){var a=new d(this.board,this.options.point1).add(),b=new d(this.board,this.options.point2).add(),c=new d(this.board,this.options.point3).add();return new e(this.board,"ellipse",[a,b,c,[a,b,c]]).add()};var h=function(a,b){this.options=b,this.board=a};h.prototype.draw=function(){var a=new d(this.board,this.options.point1).add(),b=new d(this.board,this.options.point2).add();return new e(this.board,"segment",[a,b,[a,b]]).add()};var j=function(a,b){this.options=b,this.board=a};j.prototype.draw=function(){var a=new d(this.board,this.options.point1).add(),b=new d(this.board,this.options.point2).add();return new e(this.board,"line",[a,b,[a,b]]).add()};var k=function(a,b){this.options=b,this.board=a};k.prototype.draw=function(){var a=[];for(i in this.options)a.push(new d(this.board,this.options[i]).add());a.push(a);var b=new e(this.board,"polygon",a).add();return b.hasInnerPoints=!0,b};var l=function(a,b){this.options=b,this.board=a};l.prototype.draw=function(){return new d(this.board,this.options.point).add()};var m=function(a,b){this.options=b,this.board=a};m.prototype.draw=function(){var a=new e(this.board,"functiongraph",this.options.concat(this.options[0]),{fixed:!0,strokewidth:2});return a=a.add()};var n=function(a,b){this.options=b,this.board=a};return n.prototype.draw=function(){return new e(this.board,"text",[this.options.position[0],this.options.position[1],this.options.text,[this.options.position[0],this.options.position[1]]],{fontSize:this.options.size}).add()},{Constructor:f,circle:a,angle:b,arc:c,ellipse:g,segment:h,func:m,line:j,polygon:k,point:l,text:n}}(),b.exports=f},{"./point":40,"./shape":41}],40:[function(a,b,c){var d=function(a,b){this.board=a,this.coords=b};d.prototype=function(){return{Constructor:d,add:function(){var b=!1;if(b)return b;var c=this.board.create("point",this.coords,{infoboxDigits:"none"});return Object.defineProperty(this.board.points,c.name,{value:c,enumerable:!0,configurable:!0}),c.on("mousedown",a("../helper/drag")),c.on("mouseout",function(a){this.isDraggable=!0}),c}}}(),b.exports=d},{"../helper/drag":14}],41:[function(a,b,c){var d=function(a,b,c,d){this.board=a,this.shape=b,this.parents=c,this.options=d||{}};d.prototype=function(){var b=function(){return"A"+(this.board.shapes.length+1)};return{Constructor:d,add:function(){this.options.name=this.options.name||b.call(this),this.options.withLabel=!0,this.options.hasInnerPoints=!0;var c=this.parents.pop(),d=this.board.create(this.shape,this.parents,this.options);return d.usrSetCoords="function"==typeof c?void 0:c,d.on("mouseover",a("../helper/drag")),this.board.shapes.push(d),d}}}(),b.exports=d},{"../helper/drag":14}]},{},[1]);